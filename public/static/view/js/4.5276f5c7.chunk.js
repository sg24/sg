(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{1050:function(e,a,t){},1051:function(e,a,t){},1053:function(e,a,t){"use strict";t.r(a);var r=t(55),n=t(16),s=t(17),o=t(19),i=t(18),l=t(222),c=t(20),m=t(0),d=t.n(m),u=t(4),f=t(302),p=t.n(f),_=t(369),v=t.n(_),h=t(27),g=t(113),E=(t(1050),t(96));function b(e,a){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);a&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,r)}return t}var w=function(e,a){return function(e){for(var a=1;a<arguments.length;a++){var t=null!=arguments[a]?arguments[a]:{};a%2?b(t,!0).forEach(function(a){Object(E.a)(e,a,t[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):b(t).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(t,a))})}return e}({},e,{},a)},N=function(e){var a=document.createElement("canvas");return new Promise(function(t,r){a.getContext?(a.width=e.videoWidth,a.height=e.videoHeight,a.getContext("2d").drawImage(e,0,0),a.toBlob(function(e){t(e)})):r("Please update your Browser")})},y=function(e,a){var t=!0;return!a||(a.required&&(t=""!==e.trim()&&t),a.minLength&&(t=e.length>=a.minLength&&t),t)},j=function(e){function a(){return Object(n.a)(this,a),Object(o.a)(this,Object(i.a)(a).apply(this,arguments))}return Object(c.a)(a,e),Object(s.a)(a,[{key:"render",value:function(){var e=this,a=this.props.cnt.map(function(a,t){return d.a.createElement("div",{className:"aroundme__form--itm__prev--wrapper",key:t},d.a.createElement("div",{className:"aroundme__form--itm__prev--close",onClick:e.props.removeMedia.bind(e,a.id)},d.a.createElement(u.a,{icon:["fas","times"]})),"image"===a.type?d.a.createElement("img",{src:a.url,alt:""}):d.a.createElement("video",{src:a.url,controls:!0},d.a.createElement("p",null,"our browser doesn't support embedded videos")))});return d.a.createElement("div",{className:"aroundme__form--itm__prev"},a)}}]),a}(m.Component),O=(t(1051),function(e){var a="Loading ....",t=["global"];return e.cnt&&(a=e.cnt),e.bg&&t.push("global--bg"),d.a.createElement("section",{className:t.join(" ")},d.a.createElement("div",{className:"global__wrapper"},d.a.createElement("div",null,d.a.createElement("div",{className:"top mask"},d.a.createElement("div",{className:"plane"})),d.a.createElement("div",{className:"middle mask"},d.a.createElement("div",{className:"plane"})),d.a.createElement("div",{className:"bottom mask"},d.a.createElement("div",{className:"plane"}))),d.a.createElement("p",null,a)))}),C=function(e){function a(){var e,t;Object(n.a)(this,a);for(var r=arguments.length,s=new Array(r),l=0;l<r;l++)s[l]=arguments[l];return(t=Object(o.a)(this,(e=Object(i.a)(a)).call.apply(e,[this].concat(s)))).state={formElement:{username:{value:"",validation:{required:!0,minLength:1},valid:!1,touched:!1},password:{value:"",validation:{required:!0,minLength:1},valid:!1,touched:!1}},signup:{username:{value:"",validation:{required:!0,minLength:6},valid:!1,touched:!1},email:{value:"",validation:{required:!0,minLength:6},valid:!1,touched:!1},password:{value:"",validation:{required:!0,minLength:6},valid:!1,touched:!1}},formIsValid:!1,formMode:"login",confirmPass:{value:"",valid:!1,touched:!1,err:null},err:null,start:!1,signupIsValid:!1},t.inputChangedHandler=function(e,a){var r=e.target.value,n=w(t.state.formElement[a],{value:r,valid:y(r,t.state.formElement[a].validation),touched:!0}),s=!0,o=w(t.state.formElement,Object(E.a)({},a,n));for(var i in o)s=o[i].valid&&s;t.setState({formElement:o,formIsValid:s})},t.changeTabHandler=function(e){t.setState({formMode:e,err:null})},t.contentChangedHandler=function(e,a){var r=w(t.state.signup[a],{value:e.target.value,valid:y(e.target.value,t.state.signup[a].validation),touched:!0}),n=!0,s=w(t.state.signup,Object(E.a)({},a,r));for(var o in s)n=s[o].valid&&n;t.setState({signup:s,signupIsValid:n,confirmPass:t.state.confirmPass.touched&&"password"===a&&t.state.confirmPass.value!==e.target.value?w(t.state.confirmPass,{valid:!1,err:"Password does not match"}):t.state.confirmPass.touched?w(t.state.confirmPass,{valid:!0,err:null}):t.state.confirmPass})},t.confirmPasswordHandler=function(e){var a=e.target.value;if(t.state.signup.password.value&&t.state.signup.password.valid)return t.state.signup.password.value===e.target.value?void t.setState({confirmPass:w(t.state.confirmPass,{value:a,valid:!0,err:null})}):void t.setState({confirmPass:w(t.state.confirmPass,{value:a,valid:!1,touched:!0,err:"Password does not match"})});t.setState({confirmPass:w(t.state.confirmPass,{value:a,valid:!1,touched:!0,err:"Please, enter valid password"})})},t.signupHandler=function(){if(t.state.signupIsValid&&t.state.confirmPass.valid){t.setState({start:!0,err:null});var e={username:t.state.signup.username.value,password:t.state.signup.password.value,email:t.state.signup.email.value};p.a.post("https://www.slodge24.com/signup",e).then(function(e){t.props.userAuth()}).catch(function(e){var a=null;if(e.response)if(e.response.data&&e.response.data.keyValue)for(var r in e.response.data.keyValue)a="email"===r?"".concat(r,"  already taken"):"username"===r?"".concat(r," already taken"):e.message;else a="object"!==typeof e.response.data?e.response.data:"Connection Error";else a=e.message;t.setState({err:a,start:!1})})}else;},t.loginHandler=function(){if(t.state.formIsValid){t.setState({start:!0,err:null});var e={username:t.state.formElement.username.value,password:t.state.formElement.password.value};p.a.post("https://www.slodge24.com/login",e).then(function(e){t.props.userAuth()}).catch(function(e){var a=e.response?e.response.data:e.message;t.setState({err:a,start:!1})})}else;},t}return Object(c.a)(a,e),Object(s.a)(a,[{key:"render",value:function(){var e=this,a=d.a.createElement(d.a.Fragment,null,d.a.createElement("div",{className:"aroundme__form--cnt"},d.a.createElement("div",{className:"aroundme__form--cnt--wrapper"},d.a.createElement("label",{className:"aroundme__form--cnt__title"},"Email Address"),d.a.createElement("div",{className:"aroundme__form--cnt__det"},d.a.createElement("input",{type:"email",name:"",required:!0,minLength:"1",value:this.state.formElement.username.value,className:"aroundme__form--cnt__det--input",onChange:function(a){return e.inputChangedHandler(a,"username")}})),!this.state.formElement.username.valid&&this.state.formElement.username.touched?d.a.createElement("div",{className:"aroundme__form--err"},"Email must not be empty"):null)),d.a.createElement("div",{className:"aroundme__form--cnt"},d.a.createElement("div",{className:"aroundme__form--cnt--wrapper"},d.a.createElement("label",{className:"aroundme__form--cnt__title"},"Password"),d.a.createElement("div",{className:"aroundme__form--cnt__det"},d.a.createElement("input",{type:"password",name:"",required:!0,value:this.state.formElement.password.value,className:"aroundme__form--cnt__det--input",onChange:function(a){return e.inputChangedHandler(a,"password")}})),!this.state.formElement.password.valid&&this.state.formElement.password.touched?d.a.createElement("div",{className:"aroundme__form--err"},"Password must not be empty"):null)),d.a.createElement("div",{className:"aroundme__form--footer"},d.a.createElement("button",{type:"button",className:"aroundme__form--footer__btn",onClick:this.loginHandler,disabled:!(this.state.formIsValid&&!this.state.start)},"Continue")));return"signup"===this.state.formMode&&(a=d.a.createElement(d.a.Fragment,null,d.a.createElement("div",{className:"aroundme__form--cnt"},d.a.createElement("div",{className:"aroundme__form--cnt--wrapper"},d.a.createElement("label",{className:"aroundme__form--cnt__title"},"Username"),d.a.createElement("div",{className:"aroundme__form--cnt__det"},d.a.createElement("input",{type:"text",name:"",required:!0,minLength:"6",value:this.state.signup.username.value,className:"aroundme__form--cnt__det--input",onChange:function(a){return e.contentChangedHandler(a,"username")}})),!this.state.signup.username.valid&&this.state.signup.username.touched?d.a.createElement("div",{className:"aroundme__form--err"},"Username must be longer than 5 characters"):null)),d.a.createElement("div",{className:"aroundme__form--cnt"},d.a.createElement("div",{className:"aroundme__form--cnt--wrapper"},d.a.createElement("label",{className:"aroundme__form--cnt__title"},"Email Address"),d.a.createElement("div",{className:"aroundme__form--cnt__det"},d.a.createElement("input",{type:"email",required:!0,minLength:"6",value:this.state.signup.email.value,className:"aroundme__form--cnt__det--input",onChange:function(a){return e.contentChangedHandler(a,"email")}})),!this.state.signup.email.valid&&this.state.signup.email.touched?d.a.createElement("div",{className:"aroundme__form--err"},"Email must be longer than 5 characters"):null)),d.a.createElement("div",{className:"aroundme__form--cnt"},d.a.createElement("div",{className:"aroundme__form--cnt--wrapper"},d.a.createElement("label",{className:"aroundme__form--cnt__title"},"Password"),d.a.createElement("div",{className:"aroundme__form--cnt__det"},d.a.createElement("input",{type:"password",minLength:"6",value:this.state.signup.password.value,required:!0,className:"aroundme__form--cnt__det--input",onChange:function(a){return e.contentChangedHandler(a,"password")}})),!this.state.signup.password.valid&&this.state.signup.password.touched?d.a.createElement("div",{className:"aroundme__form--err"},"Password must be longer than 5 characters"):null)),d.a.createElement("div",{className:"aroundme__form--cnt"},d.a.createElement("div",{className:"aroundme__form--cnt--wrapper"},d.a.createElement("label",{className:"aroundme__form--cnt__title"},"Confirm Password"),d.a.createElement("div",{className:"aroundme__form--cnt__det"},d.a.createElement("input",{type:"password",className:"aroundme__form--cnt__det--input",required:!0,value:this.state.confirmPass.value,onChange:function(a){return e.confirmPasswordHandler(a)}})),this.state.confirmPass.err?d.a.createElement("div",{className:"aroundme__form--err"},this.state.confirmPass.err):null)),d.a.createElement("div",{className:"aroundme__form--footer"},d.a.createElement("button",{type:"submit",className:"aroundme__form--footer__btn",onClick:this.signupHandler,disabled:!(this.state.signupIsValid&&this.state.confirmPass.valid&&!this.state.start)},"Continue")))),d.a.createElement("div",{className:"aroundme__form--auth"},d.a.createElement("ul",{className:"aroundme__form--auth__tab"},d.a.createElement("li",{className:"login"===this.state.formMode?"aroundme__form--auth__tab--active":null,onClick:this.changeTabHandler.bind(this,"login")},"Login"),d.a.createElement("li",{className:"signup"===this.state.formMode?"aroundme__form--auth__tab--active":null,onClick:this.changeTabHandler.bind(this,"signup")},"Sign Up")),this.state.err?d.a.createElement("div",{className:"aroundme__form--err"},this.state.err.toString()):null,a)}}]),a}(m.Component),k=d.a.createRef(null),P=function(e){function a(){var e,t;Object(n.a)(this,a);for(var s=arguments.length,c=new Array(s),m=0;m<s;m++)c[m]=arguments[m];return(t=Object(o.a)(this,(e=Object(i.a)(a)).call.apply(e,[this].concat(c)))).state={loc:{value:"",touched:!1,valid:!1},disableInput:!1,start:!1,err:null,loading:!1,media:[],chunks:[],auth:!1,status:!1,disable:!1,upload:0,mediaRecorder:null},t.inputChangedHandler=function(e){var a=e.target.value,r=w(t.state.loc,{value:a,valid:""!==a,touched:!0});t.setState({loc:r,err:null})},t.locationHandler=function(){var e=Object(l.a)(t);t.setState({disableInput:!0,err:null}),"navigator"in window&&"geolocation"in navigator&&navigator.geolocation.getCurrentPosition(function(a){var t={lat:a.coords.latitude,lng:a.coords.longitude};p.a.get("https://maps.googleapis.com/maps/api/geocode/json?latlng=".concat(t.lat,",").concat(t.lng,"&key=AIzaSyDIbF8oQh1APAzLLXoeLynN8vMsAKSav2g")).then(function(a){if(!a.data.error_message){var t=w(e.state.loc,{value:"In ".concat(a.data.results[0].formatted_address)});e.setState({loc:t,disableInput:!1})}}).catch(function(a){e.setState({err:"Network Error",disableInput:!1})})},function(a){e.setState({err:"Network Error",disableInput:!1})},{timeout:1e4})},t.cameraHandler=function(){t.setState({loading:!0}),"mediaDevices"in navigator||(navigator.mediaDevices={});var e=Object(l.a)(t);"getUserMedia"in navigator.mediaDevices||(navigator.mediaDevices.getUserMedia=function(a){var t=navigator.webkitGetUserMedia||navigator.mozGetUserMedia;return t?new Promise(function(e,r){t.call(navigator,a,e,r)}):e.setState({err:"Camera access not supported by Browser!"})}),navigator.mediaDevices.getUserMedia({video:!0}).then(function(a){k.current.srcObject=a,e.setState({start:!0,loading:!1})}).catch(function(a){e.setState({err:a,start:!1,loading:!1})})},t.captureHandler=function(){k&&k.current&&N(k.current).then(function(e){k.current.srcObject.getVideoTracks().forEach(function(e){e.stop()});var a=Object(r.a)(t.state.media),n=window.URL.createObjectURL(e);a.push({file:e,type:"image",id:v()(),url:n}),t.setState({media:a,start:!1,err:null})}).catch(function(e){t.setState({err:e})})},t.closeCameraHandler=function(){k&&k.current&&(k.current.srcObject.getVideoTracks().forEach(function(e){e.stop()}),t.setState({start:!1,err:null,loading:!1}))},t.removeMediaHandler=function(e){var a=Object(r.a)(t.state.media).filter(function(a){return a.id!==e});t.setState({media:a})},t.videoRecHandler=function(){t.setState({loading:!0,rec:!0});var e=Object(l.a)(t);"mediaDevices"in navigator||(navigator.mediaDevices={}),"getUserMedia"in navigator.mediaDevices||(navigator.mediaDevices.getUserMedia=function(a){var t=navigator.webkitGetUserMedia||navigator.mozGetUserMedia;return t?new Promise(function(e,r){t.call(navigator,a,e,r)}):e.setState({err:"Camera access not supported by browser!",rec:!1})}),navigator.mediaDevices.getUserMedia({audio:!0,video:!0}).then(function(a){var t=new MediaRecorder(a);t.start(),t.ondataavailable=function(a){e.state.chunks.push(a.data)},k.current.srcObject=a,e.setState({mediaRecorder:t,start:!0,loading:!1})}).catch(function(a){e.setState({err:a,start:!1,loading:!1,rec:!1})})},t.stopRecHandler=function(){var e=t.state.mediaRecorder,a=Object(l.a)(t);e.stop(),e.onstop=function(t){var n=new Blob(a.state.chunks,{type:"mp4"});e.stream.getTracks().forEach(function(e){return e.stop()});var s=Object(r.a)(a.state.media),o=window.URL.createObjectURL(n);s.push({file:n,type:"video",id:v()(),url:o}),a.setState({mediaRecorder:null,chunks:[],media:s,start:!1,err:null,rec:!1})}},t.cancelRecHandler=function(){var e=t.state.mediaRecorder;e&&(e.stream.getTracks().forEach(function(e){return e.stop()}),t.setState({mediaRecorder:null,start:!1,err:null,loading:!1,rec:!1}))},t.uploadMediaHandler=function(){document.querySelector(".aroundme__form--itm__file").click()},t.selectMediaHandler=function(e){if(e.stopPropagation(),e.preventDefault(),e.target.files){var a=e.target.files;t.handleFiles(a)}},t.handleFiles=function(e){for(var a=Object(r.a)(t.state.media),n=0;n<e.length;n++){var s=e[n];if("video"===s.type.split("/")[0]||"image"===s.type.split("/")[0]){var o=window.URL.createObjectURL(s);a.push({file:s,type:s.type.split("/")[0],id:v()(),url:o})}}t.setState({media:a})},t.userAuthHandler=function(){t.setState({auth:!1,status:!0})},t.submitFormHandler=function(e){e.preventDefault(),t.props.status||t.state.status?(t.uploadCnt(),t.setState({disable:!0})):t.setState({auth:!0})},t.uploadCnt=function(){var e=Object(l.a)(t),a=new FormData;a.append("location",t.state.loc.value);var r=!0,n=!1,s=void 0;try{for(var o,i=t.state.media[Symbol.iterator]();!(r=(o=i.next()).done);r=!0){var c=o.value,m=c.file.type.split("/").pop();"video"===c.file.type.split("/")[0]?a.append("video",c.file,"".concat(c.id,".").concat(m)):a.append("image",c.file,"".concat(c.id,".").concat(m))}}catch(d){n=!0,s=d}finally{try{r||null==i.return||i.return()}finally{if(n)throw s}}p.a.post("https://www.slodge24.com/add/aroundme",a,{onUploadProgress:function(a){if(a.lengthComputable){var t=Math.round(100*a.loaded/a.total);e.setState({upload:t})}}}).then(function(e){window.location.assign("/aroundme/chat/"+e.data)}).catch(function(e){t.setState({err:e,disable:!1})})},t.closeAroundmeHandler=function(){t.props.history.goBack(),k&&k.current&&k.current.srcObject&&k.current.srcObject.getVideoTracks().forEach(function(e){e.stop()})},t}return Object(c.a)(a,e),Object(s.a)(a,[{key:"componentWillUnmount",value:function(){k&&k.current&&k.current.srcObject&&k.current.srcObject.getVideoTracks().forEach(function(e){e.stop()})}},{key:"render",value:function(){var e=["aroundme__form--cnt__det--loc"],a=null,t=["aroundme__form--media"],r=["aroundme__form--media__vid-hide"],n=null,s=null;this.state.upload>0&&(s=d.a.createElement("div",{style:{height:2,width:"".concat(this.state.upload,"%"),backgroundColor:"#ff1600",position:"absolute",top:0}}));var o=d.a.createElement("ul",{className:"aroundme__form--opt"},d.a.createElement("li",{className:"aroundme__form--opt__camera",onClick:this.cameraHandler},d.a.createElement(u.a,{icon:["fas","camera"]})),d.a.createElement("li",{className:"aroundme__form--opt__rec",onClick:this.videoRecHandler},d.a.createElement(u.a,{icon:["fas","video"]})),d.a.createElement("li",{className:"aroundme__form--opt__file",onClick:this.uploadMediaHandler},d.a.createElement(u.a,{icon:["fas","upload"]})));!this.state.loading&&!this.state.start&&this.state.media.length>0&&(a=d.a.createElement(j,{cnt:this.state.media,removeMedia:this.removeMediaHandler})),this.state.loading&&(n=d.a.createElement("div",{className:"aroundme__form--media__loading"},d.a.createElement(O,{cnt:"Initializing camera ...",bg:!0}))),(this.state.start||this.state.loading)&&(r=["aroundme__form--media__vid-show"],t.push("aroundme__form--media__show"),o=null),this.state.disableInput&&e.push("aroundme__form--cnt__det--loc__disable");var i=d.a.createElement(d.a.Fragment,null,d.a.createElement("div",{className:"aroundme__form--cnt"},d.a.createElement("div",{className:"aroundme__form--cnt--wrapper"},d.a.createElement("label",{className:"aroundme__form--cnt__title"},"Location"),d.a.createElement("div",{className:"aroundme__form--cnt__det"},d.a.createElement("input",{type:"text",name:"",required:!0,minLength:"1",value:this.state.disableInput?"Please wait ....":this.state.loc.value,className:"aroundme__form--cnt__det--input",disabled:this.state.disableInput,onChange:this.inputChangedHandler}),d.a.createElement("div",{className:e.join(" "),onClick:this.state.disableInput?null:this.locationHandler},"Location Me")),!this.state.loc.valid&&this.state.loc.touched?d.a.createElement("div",{className:"aroundme__form--err"},"Location must not be empty"):null,this.state.err?d.a.createElement("div",{className:"aroundme__form--err"},this.state.err.toString()):null)),o,d.a.createElement("div",{className:"aroundme__form--itm"},d.a.createElement("div",{className:"aroundme__form--itm__wrapper"},d.a.createElement("input",{type:"file",multiple:!0,className:"aroundme__form--itm__file",onChange:this.selectMediaHandler,accept:"image/*,video/*"}),a)),d.a.createElement("div",{className:"aroundme__form--footer"},d.a.createElement("button",{type:"submit",className:"aroundme__form--footer__btn",disabled:!this.state.loc.value||this.state.media.length<1||this.state.disable},"Chat")));return this.state.auth&&(i=d.a.createElement(C,{userAuth:this.userAuthHandler})),d.a.createElement("form",{className:"aroundme__form",onSubmit:this.submitFormHandler},d.a.createElement("div",{className:"aroundme__form--main-wrapper"},d.a.createElement("div",{className:"aroundme__form--backdrop",onClick:this.closeAroundmeHandler}),d.a.createElement("div",{className:"aroundme__form--wrapper"},d.a.createElement("h3",{className:"aroundme__form--title"},d.a.createElement("div",null,d.a.createElement(u.a,{icon:["fas","map-marker-alt"]})),"what's going on around you now!!!!!  -  Share Selfie/video"),s,i,d.a.createElement("div",{className:t.join(" ")},d.a.createElement("video",{ref:k,autoPlay:!0,className:r.join(" ")},d.a.createElement("p",null,"our browser doesn't support embedded videos")),n,this.state.start?d.a.createElement("div",{className:"aroundme__form--media__snap"},this.state.rec?d.a.createElement(d.a.Fragment,null,d.a.createElement("div",{className:"aroundme__form--media__snap--wrapper aroundme__form--media__snap--wrapper__rec",onClick:this.stopRecHandler},d.a.createElement(u.a,{icon:["fas","video"]})),d.a.createElement("div",{className:"aroundme__form--media__snap--close",onClick:this.cancelRecHandler},d.a.createElement(u.a,{icon:["fas","times"]}))):d.a.createElement(d.a.Fragment,null,d.a.createElement("div",{className:"aroundme__form--media__snap--wrapper",onClick:this.captureHandler},d.a.createElement(u.a,{icon:["fas","camera"]})),d.a.createElement("div",{className:"aroundme__form--media__snap--close",onClick:this.closeCameraHandler},d.a.createElement(u.a,{icon:["fas","times"]})))):null))))}}]),a}(m.Component);a.default=Object(g.f)(Object(h.b)(function(e){return{status:e.auth.status}},null)(P))}}]);
//# sourceMappingURL=4.5276f5c7.chunk.js.map