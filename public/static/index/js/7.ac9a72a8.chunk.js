(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{694:function(e,t){},766:function(e,t,a){},767:function(e,t,a){},768:function(e,t,a){},769:function(e,t,a){},770:function(e,t,a){},771:function(e,t,a){},772:function(e,t,a){},773:function(e,t,a){},785:function(e,t,a){"use strict";a.r(t);var n=a(16),i=a(17),c=a(218),s=a(18),r=a(19),o=a(0),l=a.n(o),d=a(8),m=a(73),h=a(86),u=(a(766),a(767),a(37)),p=a(87),_=a(682),f=a.n(_),v=a(652),g=a.n(v),E=a(219),y=a.n(E),b=y.a.create({baseURL:"https://www.slodge24.com"});b.defaults.headers.common.authorization="authorization",b.defaults.headers.post["Content-Type"]="application/x-www-form-urlencoded";var C=b,D=function(e,t){return Object(p.a)({},e,{},t)};var I=function(e,t){var a=!0;return!t||(t.required&&(a=""!==e.trim()&&a),t.minLength&&(a=e.length>=t.minLength&&a),a)},N=function(e){var t=document.createElement("canvas");return new Promise(function(a,n){t.getContext?(t.width=e.videoWidth,t.height=e.videoHeight,t.getContext("2d").drawImage(e,0,0),t.toBlob(function(e){a(e)})):n("Please update your Browser")})},w=f()("https://www.slodge24.com"),S=[],k=function(e,t,a,n,i,c,s,r){return new Promise(function(e,r){a?(t.stop(),t.onstop=function(a){var n=new Blob(S,{type:i});S=[],t.stream.getTracks().forEach(function(e){return e.stop()}),e([{file:n,type:s,format:c,chatID:g()()}])}):(S=[],"mediaDevices"in navigator||(navigator.mediaDevices={}),"getUserMedia"in navigator.mediaDevices||(navigator.mediaDevices.getUserMedia=function(e){var t=navigator.webkitGetUserMedia||navigator.mozGetUserMedia;return t?new Promise(function(a,n){t.call(navigator,e,a,n)}):r("getUserMedia is not implemented!")}),navigator.mediaDevices.getUserMedia(n).then(function(t){var a=new MediaRecorder(t);a.start(),a.ondataavailable=function(e){S.push(e.data)},e({mediaRecorder:a,stream:t})}).catch(function(e){r(e)}))})};a(768);var H=function(e){var t=["global"],a=[""],n="Loading ....";return e.nav&&(t.push("global-nav"),a.push("global-load")),e.cnt&&(n=e.cnt),e.main&&t.push("global-bg"),e.bg&&t.push("global-nav-nobg"),l.a.createElement("section",{className:t.join(" ")},l.a.createElement("div",{className:"global__wrapper"},l.a.createElement("div",null,l.a.createElement("div",{className:"top mask"},l.a.createElement("div",{className:"plane"})),l.a.createElement("div",{className:"middle mask"},l.a.createElement("div",{className:"plane"})),l.a.createElement("div",{className:"bottom mask"},l.a.createElement("div",{className:"plane"}))),l.a.createElement("p",{className:a.join(" ")},n)))},j=(a(24),a(699)),T=a(124),x=a.n(T),M=a(93),O=a(679),P=a.n(O),R=a(674),U=a.n(R),L=function(e){var t=["site-main__chat--box__hst--cnt__wrapper"],a=["site-main__chat--box__reply--cnt__wrapper"],n=l.a.createElement("audio",{controls:!0,src:"https://www.slodge24.com/media/audio/".concat(e.cnt.msg,".").concat(e.cnt.format)},l.a.createElement("p",null,"Your browser does not support this feature")),i=l.a.createElement("video",{controls:!0,src:"https://www.slodge24.com/media/video/".concat(e.cnt.msg,".").concat(e.cnt.format)},l.a.createElement("p",null,"Your browser does not support this feature")),c=l.a.createElement("img",{src:"https://www.slodge24.com/media/image/".concat(e.cnt.msg,".").concat(e.cnt.format),alt:""}),s=e.cnt.msg,r=null,o=null;if("audio"===e.cnt.cntType||"media"===e.cnt.cntType||"image"===e.cnt.cntType||"typedPlain"===e.cnt.cntType||e.cnt.delete||e.cnt.upload||e.cnt.pending||(r=l.a.createElement(l.a.Fragment,null,l.a.createElement(U.a,Object.assign({extension:e.cnt.format?e.cnt.format.substr(0,7):e.cnt.format},R.defaultStyles[e.cnt.format],{size:100})),l.a.createElement("div",{href:"https://www.slodge24.com/media/".concat(e.cnt.cntType,"/").concat(e.cnt.msg,".").concat(e.cnt.format),onClick:e.download.bind(void 0,"https://www.slodge24.com/media/".concat(e.cnt.cntType,"/").concat(e.cnt.msg,".").concat(e.cnt.format),"".concat(e.cnt.msg,".").concat(e.cnt.format)),className:"site-main__chat--box__download"},l.a.createElement(d.a,{icon:["fas","download"],className:"icon icon__site-main--chat__box--dwn"}),"download"))),e.filterChat&&"typedPlain"===e.cnt.cntType&&(o=s.replace(e.filterChat,'<span class="site-main__chat--srch__highlight">'.concat(e.filterChat,"</span>")),s=null),e.cnt.upload&&(r=l.a.createElement("div",{className:"site-main__chat--box__upload"},l.a.createElement("div",{className:"site-main__chat--box__upload--loader"},l.a.createElement("div",{className:"c100 p".concat(e.cnt.percentage)},l.a.createElement("span",null,e.cnt.percentage,"%"),l.a.createElement("div",{className:"slice"},l.a.createElement("div",{className:"bar"}),l.a.createElement("div",{className:"fill"})))),l.a.createElement("h4",{className:"site-main__chat--box__upload--cnt"},e.cnt.cntType))),e.selected&&e.selected.length>0){var m,h=Object(M.a)(e.selected);try{for(h.s();!(m=h.n()).done;)m.value.chatID===e.cnt.chatID&&(t.push("site-main__chat--box__highlight"),a.push("site-main__chat--box__highlight"))}catch(p){h.e(p)}finally{h.f()}}e.editChat&&e.editChat.chatID&&e.editChat.chatID===e.cnt.chatID&&(t.push("site-main__chat--box__highlight-edit"),a.push("site-main__chat--box__highlight-edit")),e.cnt.delete&&(t.push("site-main__chat--box__chat-del"),a.push("site-main__chat--box__chat-del"));var u=l.a.createElement("div",{className:t.join(" "),onDoubleClick:e.cnt.upload||e.cnt.delete||e.cnt.pending?null:e.hold.bind(void 0,e.cntID,e.cnt.chatID,e.cnt.ID)},l.a.createElement("div",{dangerouslySetInnerHTML:{__html:o}}),e.cnt.upload?null:e.cnt.delete?"Deleted":"audio"===e.cnt.cntType?n:"media"===e.cnt.cntType?i:"image"===e.cnt.cntType?c:"typedPlain"===e.cnt.cntType?s:null,r,e.cnt.delete||e.cnt.ID!==e.userID?null:l.a.createElement("div",{className:e.cnt.pending?"site-main__chat--box__check-hst":"site-main__chat--box__check-hst site-main__chat--box__check--mark"},l.a.createElement(d.a,{icon:["fas","check-circle"]})));return e.cnt.position%2!==0&&(u=l.a.createElement("div",{className:a.join(" "),onDoubleClick:e.cnt.upload||e.cnt.delete||e.cnt.pending?null:e.hold.bind(void 0,e.cntID,e.cnt.chatID,e.cnt.ID)},l.a.createElement("div",{dangerouslySetInnerHTML:{__html:o}}),e.cnt.upload?null:e.cnt.delete?"Deleted":"audio"===e.cnt.cntType?n:"media"===e.cnt.cntType?i:"image"===e.cnt.cntType?c:"typedPlain"===e.cnt.cntType?s:null,r,e.cnt.delete||e.cnt.ID!==e.userID?null:l.a.createElement("div",{className:e.cnt.pending?"site-main__chat--box__check-reply":"site-main__chat--box__check-reply site-main__chat--box__check--mark"},l.a.createElement(d.a,{icon:["fas","check-circle"]})))),l.a.createElement(l.a.Fragment,null,u)},A=function(e){return x()(e.cnts,"created",{reverse:!1}).map(function(t,a){return l.a.createElement(L,{key:a,cnt:t,users:e.users,userImage:e.userImage,filterChat:e.filterChat,cntID:e.cntID,hold:e.hold,selected:e.selected,editChat:e.editChat,userID:e.userID,download:e.download})})},J=(a(769),function(e){var t=null,a=["site-main__chat--box__hst--cnt__wrapper"],n=["site-main__chat--box__reply--cnt__wrapper"],i=null;e.cnt.reply&&(i=l.a.createElement(A,{cnts:e.cnt.reply,users:e.users,userImage:e.userImage,filterChat:e.filterChat,cntID:e.cnt.chatID,hold:e.hold,selected:e.selected,userID:e.userID,editChat:e.editChat,download:e.download})),e.cnt.timeFrame&&(t=l.a.createElement("div",{className:"site-main__chat--box__date"},l.a.createElement("div",{className:"site-main__chat--box__date--wrapper"},l.a.createElement("div",{className:"site-main__chat--box__date--cur"},l.a.createElement(P.a,{calendar:{sameDay:"[Today]",nextDay:"[Tomorrow]",nextWeek:"dddd",lastDay:"[Yesterday]",lastWeek:"[Last] dddd",sameElse:"DD/MM/YYYY"}},e.cnt.timeFrame)))));var c=l.a.createElement("img",{src:e.cnt.image,alt:""});e.cnt.username&&!e.cnt.image&&(c=l.a.createElement(m.a,{name:e.cnt.username.substr(0,7),size:"40",round:!0}));var s=l.a.createElement("div",{className:"site-main__chat--box__hst--footer__user--img__status site-main__chat--box__hst--footer__user--img__status--off"}),r=l.a.createElement("audio",{controls:!0,src:"https://www.slodge24.com/media/audio/".concat(e.cnt.msg,".").concat(e.cnt.format)},l.a.createElement("p",null,"Your browser does not support this feature")),o=l.a.createElement("video",{controls:!0,src:"https://www.slodge24.com/media/video/".concat(e.cnt.msg,".").concat(e.cnt.format)},l.a.createElement("p",null,"Your browser does not support this feature")),h=l.a.createElement("img",{src:"https://www.slodge24.com/media/image/".concat(e.cnt.msg,".").concat(e.cnt.format),alt:""}),u=e.cnt.msg,p=null,_=null;if(e.selected&&e.selected.length>0){var f,v=Object(M.a)(e.selected);try{for(v.s();!(f=v.n()).done;){var g=f.value;g.mainID!==e.cnt.chatID||g.chatID||(a.push("site-main__chat--box__highlight"),n.push("site-main__chat--box__highlight"))}}catch(D){v.e(D)}finally{v.f()}}if(e.editChat&&e.editChat.mainID&&!e.editChat.chatID&&(e.editChat.mainID!==e.cnt.chatID||e.editChat.chatID||(a.push("site-main__chat--box__highlight-edit"),n.push("site-main__chat--box__highlight-edit"))),"audio"===e.cnt.cntType||"media"===e.cnt.cntType||"image"===e.cnt.cntType||"typedPlain"===e.cnt.cntType||e.cnt.delete||e.cnt.upload||e.cnt.pending||(p=l.a.createElement(l.a.Fragment,null,l.a.createElement(U.a,Object.assign({extension:e.cnt.format?e.cnt.format.substr(0,7):e.cnt.format},R.defaultStyles[e.cnt.format],{size:100})),l.a.createElement("div",{href:"https://www.slodge24.com/media/".concat(e.cnt.cntType,"/").concat(e.cnt.msg,".").concat(e.cnt.format),onClick:e.download.bind(void 0,"https://www.slodge24.com/media/".concat(e.cnt.cntType,"/").concat(e.cnt.msg,".").concat(e.cnt.format),"".concat(e.cnt.msg,".").concat(e.cnt.format)),className:"site-main__chat--box__download"},l.a.createElement(d.a,{icon:["fas","download"],className:"icon icon__site-main--chat__box--dwn"}),"download"))),e.cnt.upload&&(p=l.a.createElement("div",{className:"site-main__chat--box__upload"},l.a.createElement("div",{className:"site-main__chat--box__upload--loader"},l.a.createElement("div",{className:"c100 p".concat(e.cnt.percentage)},l.a.createElement("span",null,e.cnt.percentage,"%"),l.a.createElement("div",{className:"slice"},l.a.createElement("div",{className:"bar"}),l.a.createElement("div",{className:"fill"})))),l.a.createElement("h4",{className:"site-main__chat--box__upload--cnt"},e.cnt.cntType))),e.filterChat&&"typedPlain"===e.cnt.cntType&&(_=u.replace(e.filterChat,'<span class="site-main__chat--srch__highlight">'.concat(e.filterChat,"</span>")),u=null),e.users){var E,y=Object(M.a)(e.users);try{for(y.s();!(E=y.n()).done;){var b=E.value;b.id===e.cnt.ID&&b.status&&(s=l.a.createElement("div",{className:"site-main__chat--box__hst--footer__user--img__status site-main__chat--box__hst--footer__user--img__status--on"}))}}catch(D){y.e(D)}finally{y.f()}}e.cnt.delete&&(a.push("site-main__chat--box__chat-del"),n.push("site-main__chat--box__chat-del"));var C=l.a.createElement("div",{className:"site-main__chat--box__hst"},l.a.createElement("div",{className:"site-main__chat--box__hst--wrapper"},l.a.createElement("div",{className:"site-main__chat--box__hst--cnt"},l.a.createElement("div",{className:a.join(" "),onDoubleClick:e.cnt.upload||e.cnt.delete||e.cnt.pending?null:e.hold.bind(void 0,e.cnt.chatID,null,e.cnt.ID)},l.a.createElement("div",{dangerouslySetInnerHTML:{__html:_}}),e.cnt.upload?null:e.cnt.delete?"Deleted":"audio"===e.cnt.cntType?r:"media"===e.cnt.cntType?o:"image"===e.cnt.cntType?h:"typedPlain"===e.cnt.cntType?u:null,p,e.cnt.delete||e.cnt.ID!==e.userID?null:l.a.createElement("div",{className:e.cnt.pending?"site-main__chat--box__check-hst":"site-main__chat--box__check-hst site-main__chat--box__check--mark"},l.a.createElement(d.a,{icon:["fas","check-circle"]}))),i),e.cnt.upload||e.cnt.pending?null:l.a.createElement("ul",{className:"site-main__chat--box__hst--footer"},l.a.createElement("li",{className:"site-main__chat--box__hst--footer__user"},l.a.createElement("a",{href:"/user/profile/".concat(e.cnt.ID)},e.cnt.username.substr(0,7)),l.a.createElement("div",{className:"site-main__chat--box__hst--footer__user--img"},c,s)),l.a.createElement("li",{className:"site-main__chat--box__hst--footer__chat-tm"},l.a.createElement(P.a,{date:e.cnt.created,format:"h:mm a"})," ,"))));return e.cnt.position%2!==0&&(C=l.a.createElement("div",{className:"site-main__chat--box__reply"},l.a.createElement("div",{className:"site-main__chat--box__reply--wrapper"},l.a.createElement("div",{className:"site-main__chat--box__reply--cnt"},l.a.createElement("div",{className:n.join(" "),onDoubleClick:e.cnt.upload||e.cnt.delete||e.cnt.pending?null:e.hold.bind(void 0,e.cnt.chatID,null,e.cnt.ID)},l.a.createElement("div",{dangerouslySetInnerHTML:{__html:_}}),e.cnt.upload?null:e.cnt.delete?"Deleted":"audio"===e.cnt.cntType?r:"media"===e.cnt.cntType?o:"image"===e.cnt.cntType?h:"typedPlain"===e.cnt.cntType?u:null,p,e.cnt.delete||e.cnt.ID!==e.userID?null:l.a.createElement("div",{className:e.cnt.pending?"site-main__chat--box__check-reply":"site-main__chat--box__check-reply site-main__chat--box__check--mark"},l.a.createElement(d.a,{icon:["fas","check-circle"]}))),i),e.cnt.upload||e.cnt.pending?null:l.a.createElement("ul",{className:"site-main__chat--box__reply--footer"},l.a.createElement("li",{className:"site-main__chat--box__reply--footer__user"},l.a.createElement("a",{href:"/user/profile/".concat(e.cnt.ID)},e.cnt.username.substr(0,7)),l.a.createElement("div",{className:"site-main__chat--box__reply--footer__user--img"},c,s)),l.a.createElement("li",{className:"site-main__chat--box__reply--footer__chat-tm"},", ",l.a.createElement(P.a,{date:e.cnt.created,format:"h:mm a"})))))),l.a.createElement(l.a.Fragment,null,C,t)}),q=function(e){return x()(e.cnts,"position",{reverse:!1}).map(function(t,a){return l.a.createElement(J,{key:a,cnt:t,users:e.users,filterChat:e.filterChat,hold:e.hold,selected:e.selected,editChat:e.editChat,userID:e.userID,download:e.download})})},B=(a(770),function(e){var t=[],a=0,n=new Date;n.setHours(0,0,0,0);var i,c=new Date(n).getTime(),s=x()(e,"created",{reverse:!0}),r=Object(M.a)(s);try{for(r.s();!(i=r.n()).done;){var o=i.value,l=Object(p.a)({},o,{timeFrame:null});c>new Date(o.created).getTime()&&(l=Object(p.a)({},o,{timeFrame:c}),c=new Date(c-864e5*++a).getTime()),t.push(l)}}catch(d){r.e(d)}finally{r.f()}return t}),F=function(e,t,a,n,i){var c=x()(e,"position",{reverse:!1}),s=c.length>0?c[c.length-1]:{};if(n&&!n.editMsg)s.ID===t?(s.reply.push({ID:t,position:s.position,cntType:a,sent:!1,viewed:!1,chatID:i,mainID:s.chatID,delete:!1,pending:!0,msg:n,created:(new Date).getTime()}),c[c.length-1]=s):c.push({ID:t,position:s.position?s.position+1:0,cntType:a,sent:!1,viewed:!1,chatID:i,delete:!1,pending:!0,msg:n,reply:[],created:(new Date).getTime()});else if(n.chatID){var r=c.filter(function(e){return e.chatID===n.mainID})[0],o=c.findIndex(function(e){return e.chatID===n.mainID});if(r){var l=r.reply.filter(function(e){return e.chatID===n.chatID})[0],d=r.reply.findIndex(function(e){return e.chatID===n.chatID})[0];l&&(l.msg=n.editMsg,l.cntType="typedPlain",l.format="typedPlain",l.pending=!0),r.reply[d]=l,c[o]=r}}else{var m=c.filter(function(e){return e.chatID===n.mainID})[0],h=c.findIndex(function(e){return e.chatID===n.mainID});m&&(m.msg=n.editMsg,m.cntType="typedPlain",m.format="typedPlain",m.pending=!0),c[h]=m}return c},V=function(e,t){var a=0;return e.filter(function(e,n){return e.chatID===t[0].chatID&&(a=n,!0)})[0]?e[a]=t[0]:e.push.apply(e,Object(u.a)(t)),e},z=function(e,t,a,n,i,c){var s=t.length<1?Object(u.a)(e):Object(u.a)(t),r=x()(s,"position",{reverse:!1}),o=r.length>0?r[r.length-1]:null;if(n&&!n.mainID)if(o)if(o.ID===a){var l=0;if(o.chatID===n)o={ID:a,upload:!0,position:o.position,cntType:c,chatID:n,percentage:i,pending:!0,reply:[],created:(new Date).getTime()};else o.reply.filter(function(e,t){return e.chatID===n&&(l=t,!0)})[0]?o.reply[l].percentage=i:(o.reply.push({upload:!0,pending:!0,position:o.position,cntType:c,chatID:n,percentage:i}),o.replyID?o.replyID.push(n):o.replyID=[n]);r[r.length-1]=o}else r.push({ID:a,upload:!0,position:o.position+1,cntType:c,chatID:n,percentage:i,pending:!0,reply:[],created:(new Date).getTime()});else r.push({ID:a,upload:!0,position:0,cntType:c,chatID:n,percentage:i,pending:!0,reply:[],created:(new Date).getTime()});else{var d=n;if(d.chatID){var m=r.filter(function(e){return e.chatID===d.mainID})[0],h=r.findIndex(function(e){return e.chatID===d.mainID});if(m){var p=m.reply.filter(function(e){return e.chatID===d.chatID})[0],_=m.reply.findIndex(function(e){return e.chatID===d.chatID})[0];p&&(p.pending=!0,p.upload=!0,p.cntType=c,p.percentage=i),m.reply[_]=p,r[h]=m}}else{var f=r.filter(function(e){return e.chatID===d.mainID})[0],v=r.findIndex(function(e){return e.chatID===d.mainID});f&&(f.cntType=c,f.percentage=i,f.pending=!0,f.upload=!0),r[v]=f}}return r},Y=function(e,t,a,n,i){if(a){if(e.filter(function(e){return e.chatID===a})[0])return e=e.filter(function(e){return e.chatID!==a})}else if(e.filter(function(e){return e.mainID===n&&!e.chatID})[0]){var c,s=[],r=Object(M.a)(e);try{for(r.s();!(c=r.n()).done;){var o=c.value;(o.mainID!==n||o.chatID)&&s.push(o)}}catch(l){r.e(l)}finally{r.f()}return s}return e.push({mainID:n,chatID:a,edit:i===t}),e},$=function(e,t){if(e.length>0&&t&&t.length>0){var a,n=Object(M.a)(t);try{var i=function(){var t=a.value;if(t.chatID){var n=e.filter(function(e){return e.chatID===t.mainID})[0],i=e.findIndex(function(e){return e.chatID===t.mainID});if(n){var c=n.reply.filter(function(e){return e.chatID===t.chatID})[0],s=n.reply.findIndex(function(e){return e.chatID===t.chatID})[0];c&&(c.delete=!0),n.reply[s]=c,e[i]=n}}else{var r=e.filter(function(e){return e.chatID===t.mainID})[0],o=e.findIndex(function(e){return e.chatID===t.mainID});r&&(r.delete=!0),e[o]=r}};for(n.s();!(a=n.n()).done;)i()}catch(c){n.e(c)}finally{n.f()}}return e},W=function(e){Object(r.a)(a,e);var t=Object(s.a)(a);function a(){var e;Object(n.a)(this,a);for(var i=arguments.length,c=new Array(i),s=0;s<i;s++)c[s]=arguments[s];return(e=t.call.apply(t,[this].concat(c))).state={searchTotal:0,hold:null,scrollEnable:!1,id:e.props.match.params.id,userID:document.cookie.replace(/(?:(?:^|.*;\s*)id\s*\=\s*([^;]*).*$)|^.*$/,"$1"),chatLimit:50,height:0,err:null,chat:[],tempchat:[],chatSelected:[],removeSelected:!1,typing:[],editChat:null,chatStart:null,addChat:null,chatTotal:0,skipChat:0,chatLoaded:!1,uploadMedia:null,removeChat:null,defaultTemp:!1,scrolled:!1},e.onScroll=function(){document.querySelector(".site-main__chat--box").scrollTop<=0&&C.post("/aroundme",{id:e.state.id,skipChat:e.state.skipChat,chatLimit:e.state.chatLimit},{headers:{"data-categ":"chat"}}).then(function(t){var a=Object(u.a)(e.state.chat);t.data.chat.length>0&&(a.push.apply(a,Object(u.a)(t.data.chat)),e.setState({chat:B(a),skipChat:e.state.chatLimit+e.state.skipChat,chatTotal:t.data.chatTotal}))}).catch(function(t){e.setState({err:t})})},e.chatHoldHandler=function(t,a,n){if(e.state.tempchat<1){var i=Y(e.state.chatSelected,e.state.userID,a,t,n);e.setState({chatSelected:i,removeSelected:!1,editChat:null}),e.props.holdChat(i)}},e.chatReleasedHandler=function(t){clearTimeout(e.state.hold)},e.downloadHandler=function(e,t){Object(j.saveAs)(e,t)},e}return Object(i.a)(a,[{key:"componentDidMount",value:function(){var e=this,t=this;C.post("/aroundme",{id:this.state.id,skipChat:this.state.skipChat,chatLimit:this.state.chatLimit},{headers:{"data-categ":"chat"}}).then(function(t){var a=Object(u.a)(e.state.chat);a.push.apply(a,Object(u.a)(t.data.chat)),e.setState({chat:B(a),skipChat:e.state.chatLimit,chatTotal:t.data.chatTotal,chatLoaded:!0})}).catch(function(t){e.setState({err:t})}),w.on("newChat",function(e){t.setState({chat:V(t.state.chat,e)})}),w.on("chatRemoved",function(e){JSON.stringify(t.state.removeChat)!==JSON.stringify(e)&&t.setState({removeChat:e,chat:$(t.state.chat,e),chatSelected:[],editChat:null})}),w.on("typing",function(e){t.setState({typing:e})})}},{key:"componentDidUpdate",value:function(){var e=document.querySelector(".site-main__chat--box"),t=document.querySelector(".site-main__chat--box__wrapper");this.state.chat&&this.state.chat.length>0&&!this.state.scrollEnable&&(e.addEventListener("scroll",this.onScroll,!1),this.setState({scrollEnable:!0})),t&&document.querySelector(".site-main__chat--box__wrapper > div")&&!this.state.scrolled&&(e.scrollTop=e.scrollHeight,this.setState({scrolled:!0})),this.state.chatSelected.length<1&&t&&document.querySelector(".site-main__chat--box__wrapper > div")&&document.querySelectorAll(".site-main__chat--srch__highlight").length<1&&e.clientHeight+e.scrollTop>e.scrollHeight/2+e.scrollHeight/4&&this.state.scrolled&&(e.scrollTop=e.scrollHeight),JSON.stringify(this.state.chatStart)!==JSON.stringify(this.props.createChat)&&this.setState({chatStart:this.props.createChat,chat:F(this.state.chat,this.state.userID,this.props.createChat.msgType,this.props.createChat.msg,this.props.createChat.msgID)}),JSON.stringify(this.state.addChat)!==JSON.stringify(this.props.addChat)&&this.setState({chat:V(this.state.chat,this.props.addChat),addChat:this.props.addChat}),JSON.stringify(this.state.uploadMedia)!==JSON.stringify(this.props.uploadMedia)&&this.setState({tempchat:z(this.state.chat,this.state.tempchat,this.state.userID,this.props.uploadMedia.chatID,this.props.uploadMedia.percentage,this.props.uploadMedia.type),uploadMedia:this.props.uploadMedia,defaultTemp:!1}),!this.state.defaultTemp&&this.props.defaultTemp&&this.setState({tempchat:[],defaultTemp:this.props.defaultTemp}),!this.state.removeSelected&&this.props.removeSelected&&this.setState({chatSelected:[],removeSelected:this.props.removeSelected}),JSON.stringify(this.state.editChat)!==JSON.stringify(this.props.editChat)&&this.setState({editChat:this.props.editChat,chatSelected:[]}),JSON.stringify(this.state.removeChat)!==JSON.stringify(this.props.removeChat)&&this.setState({removeChat:this.props.removeChat,chat:$(this.state.chat,this.props.removeChat),chatSelected:[],editChat:null})}},{key:"render",value:function(){var e=null,t=l.a.createElement(H,{cnt:"loading chat ..."});return this.state.typing&&this.state.typing.length>0&&(e=l.a.createElement("div",{className:"site-main__chat--box__usr-typing"},l.a.createElement("div",{className:"site-main__chat--box__usr-typing--cir-up"}),l.a.createElement("div",{className:"site-main__chat--box__usr-typing--cir-dwn"}),l.a.createElement("div",{className:"site-main__chat--box__usr-typing--cir-up"}),l.a.createElement("div",{className:"site-main__chat--box__usr-typing--cir-dwn"}),l.a.createElement("div",{className:"site-main__chat--box__usr-typing--cir-up"}),l.a.createElement("div",{className:"site-main__chat--box__usr-typing--cir-dwn"}))),this.state.chatLoaded&&(t=l.a.createElement(q,{cnts:this.state.tempchat.length>0?this.state.tempchat:this.state.chat,users:this.state.users,userImage:this.state.userImage,filterChat:this.state.filterChat,hold:this.chatHoldHandler,released:this.chatReleasedHandler,selected:this.state.chatSelected,editChat:this.state.editChat,userID:this.state.userID,download:this.downloadHandler})),l.a.createElement(l.a.Fragment,null,this.state.err?l.a.createElement("div",{className:"site-main__chat--err"},this.state.err.message?this.state.err.message:this.state.err.toString()):null,l.a.createElement("div",{className:"site-main__chat--box"},l.a.createElement("div",{className:"site-main__chat--box__wrapper"},t,e)))}}]),a}(o.Component),G=Object(h.f)(W),K=a(220),X=(a(700),a(703)),Q=function(e){Object(r.a)(a,e);var t=Object(s.a)(a);function a(){var e;Object(n.a)(this,a);for(var i=arguments.length,s=new Array(i),r=0;r<i;r++)s[r]=arguments[r];return(e=t.call.apply(t,[this].concat(s))).state=Object(K.a)({chat:"",addItm:!1,audioRec:!1,mediaRecorder:null,vidRec:!1,id:e.props.match.params.id,addImage:!1,showEmoji:!1,disable:!1,editChat:null,err:null,resend:[],addItem:!1},"showEmoji",!1),e.chatCntHandler=function(t){e.setState({chat:t.target.value.trimLeft(),addItem:!1,showEmoji:!1,err:null});var a=Object(c.a)(e);w.emit("usertyping",{},function(e){a.setState({err:e})}),(e.state.addItem||e.state.showEmoji)&&e.props.showBackdrop(!1)},e.stopTypingHandler=function(t){var a=Object(c.a)(e);w.emit("canceltyping",{},function(e){a.setState({err:e})}),"Enter"===t.key&&e.state.chat.length>0&&e.createChatHandler()},e.showAddItmHandler=function(){e.setState(function(e,t){return{addItem:!e.addItem,showEmoji:!1,err:null}}),e.props.showBackdrop(!e.state.addItem)},e.createChatHandler=function(){e.state.editChat?e.createChat(e.state.id,"typedPlain",{editMsg:e.state.chat,mainID:e.state.editChat.mainID,chatID:e.state.editChat.chatID},g()(),"pvtcreateChat"):e.createChat(e.state.id,"typedPlain",e.state.chat,g()(),"pvtcreateChat"),e.setState({chat:"",err:null})},e.createChat=function(t,a,n,i,s){var r=Object(c.a)(e);e.props.createChatStart({msgType:a,msg:n,msgID:i}),C.post("/aroundme",{type:a,msg:n,chatID:i,id:t},{headers:{"data-categ":s}}).then(function(t){e.props.addNewChat(t.data),w.emit("pvtcreateChat",t.data,function(e){r.setState({err:e})})}).catch(function(c){var r=Object(u.a)(e.state.resend);r.push({id:t,msgType:a,msg:n,msgID:i,msgCateg:s}),e.setState({resend:r})})},e.audioRecorderHandler=function(){k(w,e.state.mediaRecorder,e.state.audioRec,{audio:!0},"audio/ogg; codecs=opus","ogg","audio","pvtMediaRecChat").then(function(t){e.state.audioRec?(e.setState({audioRec:!1,mediaRecorder:null,err:null}),e.state.editChat?e.uploadMedia([{file:t[0].file,type:t[0].type,format:t[0].format,chatID:{mainID:e.state.editChat.mainID,chatID:e.state.editChat.chatID}}]):e.uploadMedia(t)):e.setState({audioRec:!0,mediaRecorder:t.mediaRecorder,err:null})}).catch(function(t){e.setState({audioRec:!1,err:t})})},e.videoRecHandler=function(){e.props.videoRec()},e.snapshotHandler=function(){e.props.snapshot()},e.addImageHandler=function(){document.querySelector(".site-main__chat--footer__clip-itm--input").click()},e.addAudioHandler=function(){document.querySelector(".site-main__chat--footer__clip-itm--input-aud").click()},e.addDocHandler=function(){document.querySelector(".site-main__chat--footer__clip-itm--input-doc").click()},e.addVideoHandler=function(){document.querySelector(".site-main__chat--footer__clip-itm--input-vid").click()},e.selectMediaHandler=function(t){if(e.setState({disable:!0}),t.stopPropagation(),t.preventDefault(),t.target.files){var a=t.target.files;e.handleFiles(a)}},e.handleFiles=function(t){for(var a=[],n=0;n<t.length;n++){var i=t[n],c="video"===i.type.split("/")[0]?"media":i.type.split("/")[0],s=i.type.split("/")[1];c&&(e.state.editChat?a.push({file:i,type:c,format:s,chatID:{mainID:e.state.editChat.mainID,chatID:e.state.editChat.chatID}}):a.push({file:i,type:c,format:s,chatID:g()()}))}e.uploadMedia(a),e.setState({disable:!1,addItem:!1,err:null}),e.props.showBackdrop(!1)},e.emojiHandler=function(){e.setState(function(e,t){return{showEmoji:!e.showEmoji,addItem:!1,err:null}}),e.props.showBackdrop(!e.state.showEmoji)},e.addEmojiHandler=function(t){var a="".concat(e.state.chat," ").concat(t.native);e.setState({chat:a,err:null,addItem:!1,showEmoji:!1}),e.props.showBackdrop(!1)},e.shareLocationHandler=function(){var t=Object(c.a)(e);e.setState({disable:!0,addItem:!1,err:null}),e.props.showBackdrop(!1),"navigator"in window&&"geolocation"in navigator&&navigator.geolocation.getCurrentPosition(function(e){var a={lat:e.coords.latitude,lng:e.coords.longitude};y.a.get("https://maps.googleapis.com/maps/api/geocode/json?latlng=".concat(a.lat,",").concat(a.lng,"&key=AIzaSyDIbF8oQh1APAzLLXoeLynN8vMsAKSav2g")).then(function(e){e.data.error_message||(t.props.editChat?t.createChat(t.state.id,"typedPlain",{editMsg:"In ".concat(e.data.results[0].formatted_address),mainID:t.state.editChat.mainID,chatID:t.state.editChat.chatID},g()(),"pvtcreateChat"):t.createChat(t.state.id,"typedPlain","In ".concat(e.data.results[0].formatted_address),g()(),"pvtcreateChat"),t.setState({disable:!1,err:null}))}).catch(function(e){t.setState({err:e,disable:!1})})},function(e){t.setState({err:e,disable:!1})},{timeout:5e3})},e.closeModelBackdropHandler=function(){e.setState({err:null})},e.uploadMedia=function(t){var a,n=Object(c.a)(e),i=Object(M.a)(t);try{for(i.s();!(a=i.n()).done;){var s=a.value,r="media"===s.type?"video":s.type;e.props.uploadMediaStart({chatID:s.chatID,type:r,percentage:0})}}catch(o){i.e(o)}finally{i.f()}!function e(t,a){var i=new FormData;var c=t[a].file.type.split("/").pop();i.append("media",t[a].file,"".concat(t[a].chatID,".").concat(c.split(";")[0]));i.append("type","video"===t[a].type?"media":t[a].type);i.append("format",t[a].format);i.append("chatID",JSON.stringify(t[a].chatID));i.append("id",n.state.id);C.post("/aroundme",i,{headers:{"data-categ":"uploadmedia"},onUploadProgress:function(e){if(e.lengthComputable){var i=Math.round(100*e.loaded/e.total),c="media"===t[a].type?"video":t[a].type;n.props.uploadMediaStart({chatID:t[a].chatID,type:c,percentage:i})}}}).then(function(i){w.emit("pvtMediaRecChat",i.data,function(e){n.setState({err:e})}),++a,n.props.mediaUploaded(),a<t.length&&e(t,a)}).catch(function(e){++a,n.props.mediaUploaded(),n.setState({err:e})})}(t,0)},e}return Object(i.a)(a,[{key:"componentDidUpdate",value:function(){if(this.props.closeContent&&!this.state.closeContent&&this.setState({closeContent:!0,addItem:!1,showEmoji:!1}),!this.props.closeContent&&this.state.closeContent&&this.setState({closeContent:!1}),JSON.stringify(this.state.editChat)!==JSON.stringify(this.props.editChat)&&this.setState({editChat:this.props.editChat}),this.props.connect&&this.state.resend.length>0){var e=this.state.resend;this.setState({resend:[]}),function e(a,n,i){C.post("/aroundme",{type:n[i].msgType,msg:n[i].msg,chatID:n[i].msgID,id:n[i].id},{headers:{"data-categ":n[i].msgCateg}}).then(function(i){++t<n.length&&e(a,n,t),a.props.addNewChat(i.data),w.emit("pvtcreateChat",i.data,function(e){a.setState({err:e})})}).catch(function(e){++t})}(this,e,0);var t=0}}},{key:"render",value:function(){var e=["site-main__chat--footer__mic"],t=l.a.createElement("div",{className:"site-main__chat--footer__camera",onClick:this.snapshotHandler},l.a.createElement(d.a,{icon:["fas","camera"],className:"icon icon__site-main--chat__footer--camera"})),a=l.a.createElement("div",{className:"site-main__chat--footer__input--clip",onClick:this.showAddItmHandler},l.a.createElement(d.a,{icon:["fas","paperclip"],className:"icon icon__site-main--chat__footer--input__clip"})),n=null;this.state.audioRec&&e.push("site-main__chat--footer__mic--active"),(this.state.chat||this.state.audioRec)&&(t=l.a.createElement("div",{className:"site-main__chat--footer__clip",onClick:this.showAddItmHandler},l.a.createElement(d.a,{icon:["fas","paperclip"],className:"icon icon__site-main--chat__footer--clip"})),a=l.a.createElement("div",{className:"site-main__chat--footer__input--share",onClick:this.state.audioRec?this.audioRecorderHandler:this.createChatHandler},l.a.createElement(d.a,{icon:["fas","location-arrow"],className:"icon icon__site-main--chat__footer--input__share"})));var i=null;return this.state.addItem&&(i=l.a.createElement("div",{className:"site-main__chat--footer__clip-itm"},l.a.createElement("div",{className:"site-main__chat--footer__clip-itm--wrapper",onClick:this.snapshotHandler},l.a.createElement("div",{className:"site-main__chat--footer__clip-itm--cam"},l.a.createElement(d.a,{icon:["fas","camera"],className:"icon icon__site-main__chat--clip-itm"})),l.a.createElement("h4",null,"Camera")),l.a.createElement("div",{className:"site-main__chat--footer__clip-itm--wrapper",onClick:this.videoRecHandler},l.a.createElement("div",{className:"site-main__chat--footer__clip-itm--rec"},l.a.createElement(d.a,{icon:["fas","video"],className:"icon icon__site-main__chat--clip-itm"})),l.a.createElement("h4",null,"Video Recorder")),l.a.createElement("div",{className:"site-main__chat--footer__clip-itm--wrapper",onClick:this.addImageHandler},l.a.createElement("div",{className:"site-main__chat--footer__clip-itm--img-pic"},l.a.createElement(d.a,{icon:["fas","images"],className:"icon icon__site-main__chat--clip-itm"})),l.a.createElement("h4",null,"Image Picker"),l.a.createElement("input",{type:"file",multiple:!0,className:"site-main__chat--footer__clip-itm--input",onChange:this.selectMediaHandler,accept:"image/*"})),l.a.createElement("div",{className:"site-main__chat--footer__clip-itm--wrapper",onClick:this.shareLocationHandler},l.a.createElement("div",{className:"site-main__chat--footer__clip-itm--loc"},l.a.createElement(d.a,{icon:["fas","map-marker-alt"],className:"icon icon__site-main__chat--clip-itm"})),l.a.createElement("h4",null,"Share Location")),l.a.createElement("div",{className:"site-main__chat--footer__clip-itm--wrapper",onClick:this.addDocHandler},l.a.createElement("div",{className:"site-main__chat--footer__clip-itm--doc"},l.a.createElement(d.a,{icon:["fas","file"],className:"icon icon__site-main__chat--clip-itm"})),l.a.createElement("h4",null,"Documents"),l.a.createElement("input",{type:"file",multiple:!0,className:"site-main__chat--footer__clip-itm--input-doc",onChange:this.selectMediaHandler,accept:"*"})),l.a.createElement("div",{className:"site-main__chat--footer__clip-itm--wrapper",onClick:this.addAudioHandler},l.a.createElement("div",{className:"site-main__chat--footer__clip-itm--aud"},l.a.createElement(d.a,{icon:["fas","headphones"],className:"icon icon__site-main__chat--clip-itm"})),l.a.createElement("h4",null,"Audio Picker"),l.a.createElement("input",{type:"file",multiple:!0,className:"site-main__chat--footer__clip-itm--input-aud",onChange:this.selectMediaHandler,accept:"audio/*"})),l.a.createElement("div",{className:"site-main__chat--footer__clip-itm--wrapper",onClick:this.addVideoHandler},l.a.createElement("div",{className:"site-main__chat--footer__clip-itm--vid"},l.a.createElement(d.a,{icon:["fas","video"],className:"icon icon__site-main__chat--clip-itm"})),l.a.createElement("h4",null,"Video Picker"),l.a.createElement("input",{type:"file",multiple:!0,className:"site-main__chat--footer__clip-itm--input-vid",onChange:this.selectMediaHandler,accept:"video/*"})))),this.state.showEmoji&&(n=l.a.createElement(X.a,{set:"facebook",onSelect:this.addEmojiHandler,style:{position:"absolute",bottom:"100%",left:"50%",transform:"translateX(-50%)",zIndex:1}})),l.a.createElement(l.a.Fragment,null,this.state.err?l.a.createElement("div",{className:"site-main__chat--err"},this.state.err.message?this.state.err.message:this.state.err.toString()):null,l.a.createElement("div",{className:"site-main__chat--footer"},l.a.createElement("div",{className:e.join(" "),onClick:this.audioRecorderHandler},l.a.createElement(d.a,{icon:["fas","microphone"],className:"icon icon__site-main--chat__footer--mic"})),l.a.createElement("div",{className:"site-main__chat--footer__input"},l.a.createElement("form",{onSubmit:this.createChatHandler},l.a.createElement("textarea",{className:"site-main__chat--footer__input--field",placeholder:"Type something .....",autoFocus:!0,onChange:this.chatCntHandler,onKeyUp:this.stopTypingHandler,onMouseLeave:this.stopTypingHandler,value:this.state.chat,disabled:this.state.audioRec||this.state.disable})),a,l.a.createElement("div",{className:"site-main__chat--footer__input--smiles",onClick:this.emojiHandler},l.a.createElement(d.a,{icon:["far","smile"],className:"icon icon__site-main--chat__footer--input__smile"}))),t,i,n))}}]),a}(o.Component),Z=Object(h.f)(Q),ee=(a(771),l.a.createRef(null)),te=function(e){Object(r.a)(a,e);var t=Object(s.a)(a);function a(){var e;Object(n.a)(this,a);for(var i=arguments.length,s=new Array(i),r=0;r<i;r++)s[r]=arguments[r];return(e=t.call.apply(t,[this].concat(s))).state={start:!1,err:null,id:e.props.match.params.id,editChat:e.props.editChat},e.stopRecHandler=function(){ee&&ee.current&&N(ee.current).then(function(t){ee.current.srcObject.getVideoTracks().forEach(function(e){e.stop()}),e.state.editChat?e.uploadMedia([{file:t,type:"image",format:"png",chatID:{mainID:e.state.editChat.mainID,chatID:e.state.editChat.chatID}}]):e.uploadMedia([{file:t,type:"image",format:"png",chatID:g()()}]),e.props.closeMedia()}).catch(function(t){e.setState({err:t})})},e.closeRecHandler=function(){ee&&ee.current&&ee.current.srcObject&&ee.current.srcObject.getVideoTracks().forEach(function(e){e.stop()}),e.props.closeMedia()},e.uploadMedia=function(t){var a,n=Object(c.a)(e),i=Object(M.a)(t);try{for(i.s();!(a=i.n()).done;){var s=a.value,r="media"===s.type?"video":s.type;e.props.uploadMediaStart({chatID:s.chatID,type:r,percentage:0})}}catch(o){i.e(o)}finally{i.f()}!function e(t,a){var i=new FormData;var c=t[a].file.type.split("/").pop();i.append("media",t[a].file,"".concat(t[a].chatID,".").concat(c.split(";")[0]));i.append("type","video"===t[a].type?"media":t[a].type);i.append("format",t[a].format);i.append("chatID",JSON.stringify(t[a].chatID));i.append("id",n.state.id);C.post("/aroundme",i,{headers:{"data-categ":"uploadmedia"},onUploadProgress:function(e){if(e.lengthComputable){var i=Math.round(100*e.loaded/e.total),c="media"===t[a].type?"video":t[a].type;n.props.uploadMediaStart({chatID:t[a].chatID,type:c,percentage:i})}}}).then(function(i){w.emit("pvtMediaRecChat",i.data,function(e){n.setState({err:e})}),++a,n.props.mediaUploaded(),a<t.length&&e(t,a)}).catch(function(e){++a,n.props.mediaUploaded(),n.setState({err:e})})}(t,0)},e}return Object(i.a)(a,[{key:"componentDidMount",value:function(){"mediaDevices"in navigator||(navigator.mediaDevices={});var e=this;"getUserMedia"in navigator.mediaDevices||(navigator.mediaDevices.getUserMedia=function(t){var a=navigator.webkitGetUserMedia||navigator.mozGetUserMedia;return a?new Promise(function(e,n){a.call(navigator,t,e,n)}):e.setState({err:"getUserMedia is not implemented!"})}),navigator.mediaDevices.getUserMedia({video:!0}).then(function(t){ee.current.srcObject=t,e.setState({start:!0})}).catch(function(t){e.setState({err:t,start:!1})})}},{key:"componenetDidUpdate",value:function(){JSON.stringify(this.state.editChat)!==JSON.stringify(this.props.editChat)&&this.setState({editChat:this.props.editChat})}},{key:"componentWillUnmount",value:function(){ee&&ee.current&&ee.current.srcObject&&ee.current.srcObject.getVideoTracks().forEach(function(e){e.stop()})}},{key:"render",value:function(){var e=l.a.createElement(H,{bg:!0});return this.state.start&&(e=null),l.a.createElement("div",{className:"site-main__chat--cam"},this.state.err?l.a.createElement("div",{className:"site-main__chat--err"},this.state.err.message?this.state.err.message:this.state.err.toString()):null,l.a.createElement("div",{className:"site-main__chat--cam__wrapper"},e,l.a.createElement("video",{ref:ee,autoPlay:!0,className:"site-main__chat--cam__video--wrapper"},l.a.createElement("p",null,"our browser doesn't support embedded videos")),l.a.createElement("div",{className:"site-main__chat--cam__opt"},l.a.createElement("button",{onClick:this.stopRecHandler,className:"site-main__chat--cam__opt--control",disabled:!this.state.start},l.a.createElement(d.a,{icon:["fas","camera"],className:"icon icon__site-main--chat__footer--camera"})),l.a.createElement("button",{onClick:this.closeRecHandler,className:"site-main__chat--cam__close"},l.a.createElement(d.a,{icon:["fas","times"]})))))}}]),a}(o.Component),ae=Object(h.f)(te),ne=(a(772),l.a.createRef(null)),ie=function(e){Object(r.a)(a,e);var t=Object(s.a)(a);function a(){var e;Object(n.a)(this,a);for(var i=arguments.length,s=new Array(i),r=0;r<i;r++)s[r]=arguments[r];return(e=t.call.apply(t,[this].concat(s))).state={start:!1,mediaRecorder:null,id:e.props.match.params.id,editChat:e.props.editChat,err:null},e.stopRecHandler=function(){k(w,e.state.mediaRecorder,e.state.start,{video:!0,audio:!0},"video/mp4","mp4","media","pvtMediaRecChat").then(function(t){e.setState({mediaRecorder:null,start:!1}),e.state.editChat?e.uploadMedia([{file:t[0].file,type:t[0].type,format:t[0].format,chatID:{mainID:e.state.editChat.mainID,chatID:e.state.editChat.chatID}}]):e.uploadMedia(t),e.props.closeMedia()}).catch(function(t){e.setState({start:!1})})},e.closeRecHandler=function(){ne&&ne.current&&ne.current.srcObject&&ne.current.srcObject.getVideoTracks().forEach(function(e){e.stop()}),e.props.closeMedia()},e.uploadMedia=function(t){var a,n=Object(c.a)(e),i=Object(M.a)(t);try{for(i.s();!(a=i.n()).done;){var s=a.value,r="media"===s.type?"video":s.type;e.props.uploadMediaStart({chatID:s.chatID,type:r,percentage:0})}}catch(o){i.e(o)}finally{i.f()}!function e(t,a){var i=new FormData;var c=t[a].file.type.split("/").pop();i.append("media",t[a].file,"".concat(t[a].chatID,".").concat(c.split(";")[0]));i.append("type","video"===t[a].type?"media":t[a].type);i.append("format",t[a].format);i.append("chatID",JSON.stringify(t[a].chatID));i.append("id",n.state.id);C.post("/aroundme",i,{headers:{"data-categ":"uploadmedia"},onUploadProgress:function(e){if(e.lengthComputable){var i=Math.round(100*e.loaded/e.total),c="media"===t[a].type?"video":t[a].type;n.props.uploadMediaStart({chatID:t[a].chatID,type:c,percentage:i})}}}).then(function(i){w.emit("pvtMediaRecChat",i.data,function(e){n.setState({err:e})}),++a,n.props.mediaUploaded(),a<t.length&&e(t,a)}).catch(function(e){++a,n.props.mediaUploaded(),n.setState({err:e})})}(t,0)},e}return Object(i.a)(a,[{key:"componentDidMount",value:function(){var e=this;k(w,this.state.mediaRecorder,this.state.start,{video:!0,audio:!0},"video/mp4","mp4","media","pvtMediaRecChat").then(function(t){ne.current.srcObject=t.stream,e.setState({mediaRecorder:t.mediaRecorder,start:!0})}).catch(function(t){e.setState({start:!1,err:t})})}},{key:"componenetDidUpdate",value:function(){JSON.stringify(this.state.editChat)!==JSON.stringify(this.props.editChat)&&this.setState({editChat:this.props.editChat})}},{key:"componentWillUnmount",value:function(){this.state.mediaRecorder&&this.state.mediaRecorder.stream.getTracks().forEach(function(e){return e.stop()})}},{key:"render",value:function(){var e=l.a.createElement(H,{bg:!0});return this.state.start&&(e=null),l.a.createElement("div",{className:"site-main__chat--vidcam"},this.state.err?l.a.createElement("div",{className:"site-main__chat--err"},this.state.err.message?this.state.err.message:this.state.err.toString()):null,l.a.createElement("div",{className:"site-main__chat--vidcam__wrapper"},e,l.a.createElement("video",{ref:ne,autoPlay:!0,className:"site-main__chat--vidcam__video--wrapper"},l.a.createElement("p",null,"our browser doesn't support embedded videos")),l.a.createElement("div",{className:"site-main__chat--vidcam__opt"},l.a.createElement("button",{onClick:this.stopRecHandler,className:"site-main__chat--vidcam__opt--control",disabled:!this.state.start},l.a.createElement(d.a,{icon:["fas","video"],className:"icon icon__site-main--chat__footer--camera"})),l.a.createElement("button",{onClick:this.closeRecHandler,className:"site-main__chat--vidcam__opt--close"},l.a.createElement(d.a,{icon:["fas","times"]})))))}}]),a}(o.Component),ce=Object(h.f)(ie),se=(a(773),function(e){Object(r.a)(a,e);var t=Object(s.a)(a);function a(){var e;Object(n.a)(this,a);for(var i=arguments.length,c=new Array(i),s=0;s<i;s++)c[s]=arguments[s];return(e=t.call.apply(t,[this].concat(c))).state={formElement:{username:{value:"",validation:{required:!0,minLength:1},valid:!1,touched:!1},password:{value:"",validation:{required:!0,minLength:1},valid:!1,touched:!1}},signup:{username:{value:"",validation:{required:!0,minLength:6},valid:!1,touched:!1},email:{value:"",validation:{required:!0,minLength:6},valid:!1,touched:!1},password:{value:"",validation:{required:!0,minLength:6},valid:!1,touched:!1}},formIsValid:!1,formMode:"login",confirmPass:{value:"",valid:!1,touched:!1,err:null},err:null,start:!1,signupIsValid:!1},e.inputChangedHandler=function(t,a){var n=t.target.value,i=D(e.state.formElement[a],{value:n,valid:I(n,e.state.formElement[a].validation),touched:!0}),c=!0,s=D(e.state.formElement,Object(K.a)({},a,i));for(var r in s)c=s[r].valid&&c;e.setState({formElement:s,formIsValid:c})},e.changeTabHandler=function(t){e.setState({formMode:t,err:null})},e.contentChangedHandler=function(t,a){var n=D(e.state.signup[a],{value:t.target.value,valid:I(t.target.value,e.state.signup[a].validation),touched:!0}),i=!0,c=D(e.state.signup,Object(K.a)({},a,n));for(var s in c)i=c[s].valid&&i;e.setState({signup:c,signupIsValid:i,confirmPass:e.state.confirmPass.touched&&"password"===a&&e.state.confirmPass.value!==t.target.value?D(e.state.confirmPass,{valid:!1,err:"Password does not match"}):e.state.confirmPass.touched?D(e.state.confirmPass,{valid:!0,err:null}):e.state.confirmPass})},e.confirmPasswordHandler=function(t){var a=t.target.value;if(e.state.signup.password.value&&e.state.signup.password.valid)return e.state.signup.password.value===t.target.value?void e.setState({confirmPass:D(e.state.confirmPass,{value:a,valid:!0,err:null})}):void e.setState({confirmPass:D(e.state.confirmPass,{value:a,valid:!1,touched:!0,err:"Password does not match"})});e.setState({confirmPass:D(e.state.confirmPass,{value:a,valid:!1,touched:!0,err:"Please, enter valid password"})})},e.signupHandler=function(){if(e.state.signupIsValid&&e.state.confirmPass.valid){e.setState({start:!0,err:null});var t={username:e.state.signup.username.value,password:e.state.signup.password.value,email:e.state.signup.email.value};y.a.post("https://www.slodge24.com/signup",t).then(function(t){e.props.userAuth()}).catch(function(t){var a=null;if(t.response)if(t.response.data&&t.response.data.keyValue)for(var n in t.response.data.keyValue)a="email"===n?"".concat(n,"  already taken"):"username"===n?"".concat(n," already taken"):t.message;else a="object"!==typeof t.response.data?t.response.data:"Connection Error";else a=t.message;e.setState({err:a,start:!1})})}else;},e.loginHandler=function(){if(e.state.formIsValid){e.setState({start:!0,err:null});var t={username:e.state.formElement.username.value,password:e.state.formElement.password.value};y.a.post("https://www.slodge24.com/login",t).then(function(t){e.props.userAuth()}).catch(function(t){var a=t.response?t.response.data:t.message;e.setState({err:a,start:!1})})}else;},e}return Object(i.a)(a,[{key:"render",value:function(){var e=this,t=l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{className:"aroundme__form--cnt"},l.a.createElement("div",{className:"aroundme__form--cnt--wrapper"},l.a.createElement("label",{className:"aroundme__form--cnt__title"},"Email Address"),l.a.createElement("div",{className:"aroundme__form--cnt__det"},l.a.createElement("input",{type:"email",name:"",required:!0,minLength:"1",value:this.state.formElement.username.value,className:"aroundme__form--cnt__det--input",onChange:function(t){return e.inputChangedHandler(t,"username")}})),!this.state.formElement.username.valid&&this.state.formElement.username.touched?l.a.createElement("div",{className:"aroundme__form--err"},"Email must not be empty"):null)),l.a.createElement("div",{className:"aroundme__form--cnt"},l.a.createElement("div",{className:"aroundme__form--cnt--wrapper"},l.a.createElement("label",{className:"aroundme__form--cnt__title"},"Password"),l.a.createElement("div",{className:"aroundme__form--cnt__det"},l.a.createElement("input",{type:"password",name:"",required:!0,value:this.state.formElement.password.value,className:"aroundme__form--cnt__det--input",onChange:function(t){return e.inputChangedHandler(t,"password")}})),!this.state.formElement.password.valid&&this.state.formElement.password.touched?l.a.createElement("div",{className:"aroundme__form--err"},"Password must not be empty"):null)),l.a.createElement("div",{className:"aroundme__form--footer"},l.a.createElement("button",{type:"button",className:"aroundme__form--footer__btn",onClick:this.loginHandler,disabled:!(this.state.formIsValid&&!this.state.start)},"Continue")));return"signup"===this.state.formMode&&(t=l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{className:"aroundme__form--cnt"},l.a.createElement("div",{className:"aroundme__form--cnt--wrapper"},l.a.createElement("label",{className:"aroundme__form--cnt__title"},"Username"),l.a.createElement("div",{className:"aroundme__form--cnt__det"},l.a.createElement("input",{type:"text",name:"",required:!0,minLength:"6",value:this.state.signup.username.value,className:"aroundme__form--cnt__det--input",onChange:function(t){return e.contentChangedHandler(t,"username")}})),!this.state.signup.username.valid&&this.state.signup.username.touched?l.a.createElement("div",{className:"aroundme__form--err"},"Username must be longer than 5 characters"):null)),l.a.createElement("div",{className:"aroundme__form--cnt"},l.a.createElement("div",{className:"aroundme__form--cnt--wrapper"},l.a.createElement("label",{className:"aroundme__form--cnt__title"},"Email Address"),l.a.createElement("div",{className:"aroundme__form--cnt__det"},l.a.createElement("input",{type:"email",required:!0,minLength:"6",value:this.state.signup.email.value,className:"aroundme__form--cnt__det--input",onChange:function(t){return e.contentChangedHandler(t,"email")}})),!this.state.signup.email.valid&&this.state.signup.email.touched?l.a.createElement("div",{className:"aroundme__form--err"},"Email must be longer than 5 characters"):null)),l.a.createElement("div",{className:"aroundme__form--cnt"},l.a.createElement("div",{className:"aroundme__form--cnt--wrapper"},l.a.createElement("label",{className:"aroundme__form--cnt__title"},"Password"),l.a.createElement("div",{className:"aroundme__form--cnt__det"},l.a.createElement("input",{type:"password",minLength:"6",value:this.state.signup.password.value,required:!0,className:"aroundme__form--cnt__det--input",onChange:function(t){return e.contentChangedHandler(t,"password")}})),!this.state.signup.password.valid&&this.state.signup.password.touched?l.a.createElement("div",{className:"aroundme__form--err"},"Password must be longer than 5 characters"):null)),l.a.createElement("div",{className:"aroundme__form--cnt"},l.a.createElement("div",{className:"aroundme__form--cnt--wrapper"},l.a.createElement("label",{className:"aroundme__form--cnt__title"},"Confirm Password"),l.a.createElement("div",{className:"aroundme__form--cnt__det"},l.a.createElement("input",{type:"password",className:"aroundme__form--cnt__det--input",required:!0,value:this.state.confirmPass.value,onChange:function(t){return e.confirmPasswordHandler(t)}})),this.state.confirmPass.err?l.a.createElement("div",{className:"aroundme__form--err"},this.state.confirmPass.err):null)),l.a.createElement("div",{className:"aroundme__form--footer"},l.a.createElement("button",{type:"submit",className:"aroundme__form--footer__btn",onClick:this.signupHandler,disabled:!(this.state.signupIsValid&&this.state.confirmPass.valid&&!this.state.start)},"Continue")))),l.a.createElement("div",{className:"aroundme__form--auth"},l.a.createElement("ul",{className:"aroundme__form--auth__tab"},l.a.createElement("li",{className:"login"===this.state.formMode?"aroundme__form--auth__tab--active":null,onClick:this.changeTabHandler.bind(this,"login")},"Login"),l.a.createElement("li",{className:"signup"===this.state.formMode?"aroundme__form--auth__tab--active":null,onClick:this.changeTabHandler.bind(this,"signup")},"Sign Up")),this.state.err?l.a.createElement("div",{className:"aroundme__form--err"},this.state.err.toString()):null,t)}}]),a}(o.Component)),re=function(e){Object(r.a)(a,e);var t=Object(s.a)(a);function a(e){var i;Object(n.a)(this,a),(i=t.call(this,e)).userAuthHandler=function(){i.setState({auth:!0})},i.closeAroundmeHandler=function(){i.props.history.push("/index/aroundme")},i.showBackdropHandler=function(e){i.setState({showBackdrop:e,closeContent:!1})},i.closeBackdropHandler=function(){i.setState({closeContent:!0,showBackdrop:!1})},i.createChatStartHandler=function(e){i.setState({createChat:e})},i.addNewChatHandler=function(e){i.setState({addChat:e,editChat:null})},i.uploadMediaStartHandler=function(e){i.setState({uploadMedia:e,defaultTemp:!1})},i.mediaUploadedHandler=function(){i.setState({defaultTemp:!0,editChat:null})},i.snapshotHandler=function(){i.setState({snapshot:!0})},i.videoRecHandler=function(){i.setState({videoRec:!0})},i.holdChatHandler=function(e){i.setState({chatSelected:e,removeSelected:!1,editChat:null})},i.editChatHandler=function(){i.setState({editChat:i.state.chatSelected[0],chatSelected:[]})},i.deleteChatHandler=function(){var e=Object(c.a)(i);i.setState({disable:!0}),C.post("/aroundme",{cnt:i.state.chatSelected,id:i.state.id},{headers:{"data-categ":"pvtDeleteChat"}}).then(function(t){w.emit("pvtDeleteChat",t.data,function(t){e.setState({err:t})}),e.setState({removeChat:t.data,chatSelected:null,editChat:null,disable:!1})}).catch(function(t){e.setState({err:t})})},i.closeSelectedHandler=function(){i.setState({removeSelected:!0,chatSelected:null})},i.closeMediaHandler=function(){i.setState({snapshot:!1,videoRec:!1,closeContent:!0,showBackdrop:!1})};var s=document.cookie.replace(/(?:(?:^|.*;\s*)expiresIn\s*\=\s*([^;]*).*$)|^.*$/,"$1"),r=!1;return r=!!(s&&new Date(new Date(1e3*s).getTime())>=(new Date).getTime()),i.state={userDet:null,id:i.props.match.params.id,userID:document.cookie.replace(/(?:(?:^|.*;\s*)id\s*\=\s*([^;]*).*$)|^.*$/,"$1"),showBackdrop:!1,closeContent:!1,createChat:null,addChat:null,uploadMedia:null,chatSelected:null,editChat:null,defaultTemp:!1,snapshot:!1,removeSelected:!1,removeChat:null,disable:!1,connect:!1,auth:r,err:null},i}return Object(i.a)(a,[{key:"componentDidMount",value:function(){var e=this,t=this;C.post("/aroundme",{id:this.state.id},{headers:{"data-categ":"userDet"}}).then(function(t){e.setState({userDet:t.data})}).catch(function(t){e.setState({err:t})}),w.on("connect",function(e){w.emit("join",{room:t.state.id,host:t.state.userID,public:!0},function(e){t.setState({err:e})}),t.setState({connect:!0})}),w.on("disconnect",function(){t.setState({connect:!1})}),w.disconnected||t.setState({connect:!0})}},{key:"render",value:function(){var e=l.a.createElement(H,null),t=null,a=["site-main__chat--opt__del"];if(this.state.disable&&a.push("site-main__chat--opt__del--disable"),this.state.chatSelected&&this.state.chatSelected.length>0&&(t=l.a.createElement("div",{className:"site-main__chat--opt__wrapper"},l.a.createElement("div",{className:"site-main__chat--opt__close",onClick:this.closeSelectedHandler},l.a.createElement(d.a,{icon:["fas","times"],className:"icon icon__site-main--chat__close"})),l.a.createElement("ul",{className:"site-main__chat--opt"},l.a.createElement("li",{onClick:this.state.disable?null:this.deleteChatHandler,className:a.join(" ")},l.a.createElement(d.a,{icon:["far","trash-alt"],className:"icon icon__site-main--chat__header--opt"})),this.state.chatSelected.length<2&&this.state.chatSelected[0].edit?l.a.createElement("li",{onClick:!this.state.disable&&this.state.chatSelected[0].edit?this.editChatHandler:null,className:"site-main__chat--opt__edit"},l.a.createElement(d.a,{icon:["far","edit"],className:"icon icon__site-main--chat__header--opt"})):null),l.a.createElement("div",{className:"site-main__chat--opt__total"},this.state.chatSelected.length))),this.state.userDet){var n=l.a.createElement(m.a,{name:this.state.userDet.username,size:"40",round:!0}),i=l.a.createElement("div",{className:"site-main__chat--header__status"});this.state.userDet.image&&this.state.userDet.image.length>0&&(n=l.a.createElement("img",{src:this.state.userDet.image,alt:"group"}));var c=null;this.state.userDet.status&&(c=l.a.createElement("div",{className:"site-main__chat--header__img--status"})),this.state.connect&&(i=l.a.createElement("div",{className:"site-main__chat--header__status site-main__chat--header__status-on"}));var s=l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{className:"site-main__chat--header__img"},n,c),l.a.createElement("h3",{className:"site-main__chat--header__title"},this.state.userDet.username),l.a.createElement("div",{className:"site-main__chat--header__det"},l.a.createElement("div",null,l.a.createElement(d.a,{icon:["fas","map-marker-alt"],className:"icon icon__site-main--chat__header--map"})),this.state.userDet.location));e=l.a.createElement("div",{className:"site-main__chat"},this.state.showBackdrop?l.a.createElement("div",{className:"site-main__chat--overlay",onClick:this.closeBackdropHandler}):null,l.a.createElement("div",{className:"site-main__chat--main"},l.a.createElement("div",{className:"site-main__chat--main__wrapper"},this.state.err?l.a.createElement("div",{className:"site-main__chat--err"},this.state.err.message?this.state.err.message:this.state.err.toString()):null,l.a.createElement("div",{className:"site-main__chat--header"},l.a.createElement("div",{className:"site-main__chat--header__wrapper"},s),i),t,l.a.createElement(G,{createChat:this.state.createChat,addChat:this.state.addChat,uploadMedia:this.state.uploadMedia,defaultTemp:this.state.defaultTemp,holdChat:this.holdChatHandler,removeSelected:this.state.removeSelected,editChat:this.state.editChat,removeChat:this.state.removeChat}),l.a.createElement(Z,{showBackdrop:this.showBackdropHandler,closeContent:this.state.closeContent,createChatStart:this.createChatStartHandler,addNewChat:this.addNewChatHandler,connect:this.state.connect,uploadMediaStart:this.uploadMediaStartHandler,mediaUploaded:this.mediaUploadedHandler,snapshot:this.snapshotHandler,videoRec:this.videoRecHandler,editChat:this.state.editChat}),this.state.snapshot?l.a.createElement(ae,{closeMedia:this.closeMediaHandler,uploadMediaStart:this.uploadMediaStartHandler,mediaUploaded:this.mediaUploadedHandler,editChat:this.state.editChat}):null,this.state.videoRec?l.a.createElement(ce,{closeMedia:this.closeMediaHandler,uploadMediaStart:this.uploadMediaStartHandler,mediaUploaded:this.mediaUploadedHandler,editChat:this.state.editChat}):null)))}return this.state.auth||(e=l.a.createElement(se,{userAuth:this.userAuthHandler})),l.a.createElement("div",{className:"reuse-mainchat"},l.a.createElement("div",{className:"reuse-mainchat__main-wrapper"},l.a.createElement("div",{className:"reuse-mainchat__backdrop",onClick:this.closeAroundmeHandler}),l.a.createElement("div",{className:"reuse-mainchat__wrapper"},e)))}}]),a}(o.Component);t.default=Object(h.f)(re)}}]);
//# sourceMappingURL=7.ac9a72a8.chunk.js.map