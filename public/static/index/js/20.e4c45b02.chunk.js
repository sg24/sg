(window.webpackJsonp=window.webpackJsonp||[]).push([[20],{684:function(e,a,t){"use strict";t.d(a,"b",function(){return r}),t.d(a,"a",function(){return i});var n=t(87),r=function(e,a){return Object(n.a)({},e,{},a)},i=function(e){var a=document.createElement("canvas");return new Promise(function(t,n){a.getContext?(a.width=e.videoWidth,a.height=e.videoHeight,a.getContext("2d").drawImage(e,0,0),a.toBlob(function(e){t(e)})):n("Please update your Browser")})}},759:function(e,a,t){},760:function(e,a,t){},792:function(e,a,t){"use strict";t.r(a);var n=t(93),r=t(37),i=t(15),o=t(16),c=t(218),s=t(17),l=t(18),m=t(0),d=t.n(m),u=t(8),p=t(219),f=t.n(p),_=t(652),v=t.n(_),h=t(24),g=t(86),E=(t(673),t(674)),b=(t(759),t(684)),w=function(e){Object(l.a)(t,e);var a=Object(s.a)(t);function t(){return Object(i.a)(this,t),a.apply(this,arguments)}return Object(o.a)(t,[{key:"render",value:function(){var e=this,a=this.props.cnt.map(function(a,t){return d.a.createElement("div",{className:"aroundme__form--itm__prev--wrapper",key:t},d.a.createElement("div",null,d.a.createElement("div",{className:"aroundme__form--itm__prev--close",onClick:e.props.removeMedia.bind(e,a.id)},d.a.createElement(u.a,{icon:["fas","times"]})),"image"===a.type?d.a.createElement("img",{src:a.url,alt:""}):d.a.createElement("video",{src:a.url,controls:!0},d.a.createElement("p",null,"our browser doesn't support embedded videos"))))});return d.a.createElement("div",{className:"aroundme__form--itm__prev"},a)}}]),t}(m.Component),j=(t(760),function(e){var a="Loading ....",t=["global"];return e.cnt&&(a=e.cnt),e.bg&&t.push("global--bg"),d.a.createElement("section",{className:t.join(" ")},d.a.createElement("div",{className:"global__wrapper"},d.a.createElement("div",null,d.a.createElement("div",{className:"top mask"},d.a.createElement("div",{className:"plane"})),d.a.createElement("div",{className:"middle mask"},d.a.createElement("div",{className:"plane"})),d.a.createElement("div",{className:"bottom mask"},d.a.createElement("div",{className:"plane"}))),d.a.createElement("p",null,a)))}),N=d.a.createRef(null),k=function(e){Object(l.a)(t,e);var a=Object(s.a)(t);function t(){var e;Object(i.a)(this,t);for(var o=arguments.length,s=new Array(o),l=0;l<o;l++)s[l]=arguments[l];return(e=a.call.apply(a,[this].concat(s))).state={post:{value:"",touched:!1,valid:!1},disableInput:!1,start:!1,err:null,loading:!1,media:[],chunks:[],auth:!1,status:!1,disable:!1,upload:0,mediaRecorder:null,showEmoji:!1},e.inputChangedHandler=function(a){var t=a.target.value,n=Object(b.b)(e.state.post,{value:t,valid:""!==t,touched:!0});e.setState({post:n,err:null})},e.addEmojiHandler=function(a){var t="".concat(e.state.post.value," ").concat(a.native),n=Object(b.b)(e.state.post,{value:t,valid:""!==t,touched:!0});e.setState({post:n,err:null})},e.cameraHandler=function(){e.setState({loading:!0}),"mediaDevices"in navigator||(navigator.mediaDevices={});var a=Object(c.a)(e);"getUserMedia"in navigator.mediaDevices||(navigator.mediaDevices.getUserMedia=function(e){var t=navigator.webkitGetUserMedia||navigator.mozGetUserMedia;return t?new Promise(function(a,n){t.call(navigator,e,a,n)}):a.setState({err:"Camera access not supported by Browser!"})}),navigator.mediaDevices.getUserMedia({video:!0}).then(function(e){N.current.srcObject=e,a.setState({start:!0,loading:!1})}).catch(function(e){a.setState({err:e,start:!1,loading:!1})})},e.captureHandler=function(){N&&N.current&&Object(b.a)(N.current).then(function(a){N.current.srcObject.getVideoTracks().forEach(function(e){e.stop()});var t=Object(r.a)(e.state.media),n=window.URL.createObjectURL(a);t.push({file:a,type:"image",id:v()(),url:n}),e.setState({media:t,start:!1,err:null})}).catch(function(a){e.setState({err:a})})},e.closeCameraHandler=function(){N&&N.current&&(N.current.srcObject.getVideoTracks().forEach(function(e){e.stop()}),e.setState({start:!1,err:null,loading:!1}))},e.removeMediaHandler=function(a){var t=Object(r.a)(e.state.media).filter(function(e){return e.id!==a});e.setState({media:t})},e.videoRecHandler=function(){e.setState({loading:!0,rec:!0});var a=Object(c.a)(e);"mediaDevices"in navigator||(navigator.mediaDevices={}),"getUserMedia"in navigator.mediaDevices||(navigator.mediaDevices.getUserMedia=function(e){var t=navigator.webkitGetUserMedia||navigator.mozGetUserMedia;return t?new Promise(function(a,n){t.call(navigator,e,a,n)}):a.setState({err:"Camera access not supported by browser!",rec:!1})}),navigator.mediaDevices.getUserMedia({audio:!0,video:!0}).then(function(e){var t=new MediaRecorder(e);t.start(),t.ondataavailable=function(e){a.state.chunks.push(e.data)},N.current.srcObject=e,a.setState({mediaRecorder:t,start:!0,loading:!1})}).catch(function(e){a.setState({err:e,start:!1,loading:!1,rec:!1})})},e.stopRecHandler=function(){var a=e.state.mediaRecorder,t=Object(c.a)(e);a.stop(),a.onstop=function(e){var n=new Blob(t.state.chunks,{type:"mp4"});a.stream.getTracks().forEach(function(e){return e.stop()});var i=Object(r.a)(t.state.media),o=window.URL.createObjectURL(n);i.push({file:n,type:"video",id:v()(),url:o}),t.setState({mediaRecorder:null,chunks:[],media:i,start:!1,err:null,rec:!1})}},e.cancelRecHandler=function(){var a=e.state.mediaRecorder;a&&(a.stream.getTracks().forEach(function(e){return e.stop()}),e.setState({mediaRecorder:null,start:!1,err:null,loading:!1,rec:!1}))},e.uploadMediaHandler=function(){document.querySelector(".aroundme__form--itm__file").click()},e.uploadImageHandler=function(){document.querySelector(".aroundme__form--itm__img").click()},e.uploadVideoHandler=function(){document.querySelector(".aroundme__form--itm__vid").click()},e.showEmojiHandler=function(){e.setState({showEmoji:!e.state.showEmoji})},e.selectMediaHandler=function(a){if(a.stopPropagation(),a.preventDefault(),a.target.files){var t=a.target.files;e.handleFiles(t)}},e.handleFiles=function(a){for(var t=Object(r.a)(e.state.media),n=0;n<a.length;n++){var i=a[n];if("video"===i.type.split("/")[0]||"image"===i.type.split("/")[0]){var o=window.URL.createObjectURL(i);t.push({file:i,type:i.type.split("/")[0],id:v()(),url:o})}}e.setState({media:t})},e.userAuthHandler=function(){e.setState({auth:!1,status:!0})},e.submitFormHandler=function(a){a.preventDefault(),e.uploadCnt(),e.setState({disable:!0})},e.closeAroundmeHandler=function(){e.props.history.goBack(),N&&N.current&&N.current.srcObject&&N.current.srcObject.getVideoTracks().forEach(function(e){e.stop()})},e.uploadCnt=function(){var a=Object(c.a)(e),t=new FormData;t.append("post",e.state.post.value);var r,i=Object(n.a)(e.state.media);try{for(i.s();!(r=i.n()).done;){var o=r.value,s=o.file.type.split("/").pop();"video"===o.file.type.split("/")[0]?t.append("video",o.file,"".concat(o.id,".").concat(s)):t.append("image",o.file,"".concat(o.id,".").concat(s))}}catch(l){i.e(l)}finally{i.f()}f.a.post("https://www.slodge24.com/add/aroundme",t,{onUploadProgress:function(e){if(e.lengthComputable){var t=Math.round(100*e.loaded/e.total);a.setState({upload:t})}}}).then(function(e){a.props.history.push("/index/aroundme")}).catch(function(a){e.setState({err:a,disable:!1})})},e}return Object(o.a)(t,[{key:"componentWillUnmount",value:function(){N&&N.current&&N.current.srcObject&&N.current.srcObject.getVideoTracks().forEach(function(e){e.stop()})}},{key:"render",value:function(){var e=null,a=null,t=["aroundme__form--media"],n=["aroundme__form--media__vid-hide"],r=null,i=null;this.state.upload>0&&(i=d.a.createElement("div",{style:{height:4,width:"".concat(this.state.upload,"%"),backgroundColor:"#16cf27",position:"absolute",top:0}}));var o=d.a.createElement("ul",{className:"aroundme__form--opt"},d.a.createElement("li",{className:"aroundme__form--opt__camera",onClick:this.cameraHandler},d.a.createElement(u.a,{icon:["fas","camera"]})),d.a.createElement("li",{className:"aroundme__form--opt__rec",onClick:this.videoRecHandler},d.a.createElement("div",null),d.a.createElement(u.a,{icon:["fas","video"]})),d.a.createElement("li",{className:"aroundme__form--opt__img",onClick:this.uploadImageHandler},d.a.createElement(u.a,{icon:["fas","images"]})),d.a.createElement("li",{className:"aroundme__form--opt__video",onClick:this.uploadVideoHandler},d.a.createElement(u.a,{icon:["fas","video"]})),d.a.createElement("li",{className:"aroundme__form--opt__file",onClick:this.uploadMediaHandler},d.a.createElement(u.a,{icon:["fas","upload"]})),d.a.createElement("li",{className:"aroundme__form--opt__smile",onClick:this.showEmojiHandler},d.a.createElement(u.a,{icon:["fas","smile"]})));this.state.showEmoji&&(e=d.a.createElement("div",{className:"aroundme__form--emoji"},d.a.createElement("div",{onClick:this.showEmojiHandler}),d.a.createElement(E.a,{set:"facebook",onSelect:this.addEmojiHandler}))),!this.state.loading&&!this.state.start&&this.state.media.length>0&&(a=d.a.createElement(w,{cnt:this.state.media,removeMedia:this.removeMediaHandler})),this.state.loading&&(r=d.a.createElement("div",{className:"aroundme__form--media__loading"},d.a.createElement(j,{cnt:"Initializing camera ...",bg:!0}))),(this.state.start||this.state.loading)&&(n=["aroundme__form--media__vid-show"],t.push("aroundme__form--media__show"),o=null);var c=d.a.createElement(d.a.Fragment,null,d.a.createElement("div",{className:"aroundme__form--cnt"},d.a.createElement("div",{className:"aroundme__form--cnt--wrapper"},d.a.createElement("textarea",{value:this.state.post.value,className:"aroundme__form--cnt__det--input aroundme__form--cnt__det--text",disabled:this.state.disableInput,placeholder:"Write something ....",onChange:this.inputChangedHandler}),this.state.err?d.a.createElement("div",{className:"aroundme__form--err"},this.state.err.toString()):null,e)),o,d.a.createElement("div",{className:"aroundme__form--itm"},d.a.createElement("div",{className:"aroundme__form--itm__wrapper"},d.a.createElement("input",{type:"file",multiple:!0,className:"aroundme__form--itm__file",onChange:this.selectMediaHandler,accept:"*"}),d.a.createElement("input",{type:"file",multiple:!0,className:"aroundme__form--itm__file aroundme__form--itm__vid",onChange:this.selectMediaHandler,accept:"video/*"}),d.a.createElement("input",{type:"file",multiple:!0,className:"aroundme__form--itm__file aroundme__form--itm__img",onChange:this.selectMediaHandler,accept:"image/*"}),a)),d.a.createElement("div",{className:"aroundme__form--footer"},d.a.createElement("button",{type:"submit",className:"aroundme__form--footer__btn",disabled:!this.state.post.value&&this.state.media.length<1||this.state.disable},"Post")));return this.state.auth,d.a.createElement("form",{className:"aroundme__form",onSubmit:this.submitFormHandler},d.a.createElement("div",{className:"aroundme__form--main-cnt"},d.a.createElement("div",{className:"aroundme__form--backdrop",onClick:this.closeAroundmeHandler}),d.a.createElement("div",{className:"aroundme__form--wrapper"},i,c,d.a.createElement("div",{className:t.join(" ")},d.a.createElement("video",{ref:N,autoPlay:!0,className:n.join(" ")},d.a.createElement("p",null,"our browser doesn't support embedded videos")),r,this.state.start?d.a.createElement("div",{className:"aroundme__form--media__snap"},this.state.rec?d.a.createElement(d.a.Fragment,null,d.a.createElement("div",{className:"aroundme__form--media__snap--wrapper aroundme__form--media__snap--wrapper__rec",onClick:this.stopRecHandler},d.a.createElement(u.a,{icon:["fas","video"]})),d.a.createElement("div",{className:"aroundme__form--media__snap--close",onClick:this.cancelRecHandler},d.a.createElement(u.a,{icon:["fas","times"]}))):d.a.createElement(d.a.Fragment,null,d.a.createElement("div",{className:"aroundme__form--media__snap--wrapper",onClick:this.captureHandler},d.a.createElement(u.a,{icon:["fas","camera"]})),d.a.createElement("div",{className:"aroundme__form--media__snap--close",onClick:this.closeCameraHandler},d.a.createElement(u.a,{icon:["fas","times"]})))):null))))}}]),t}(m.Component);a.default=Object(g.f)(Object(h.b)(function(e){return{status:e.auth.status}},null)(k))}}]);
//# sourceMappingURL=20.e4c45b02.chunk.js.map