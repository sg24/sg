(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{666:function(e,a,t){"use strict";t.d(a,"b",function(){return r}),t.d(a,"a",function(){return i});var n=t(39),r=function(e,a){return Object(n.a)(Object(n.a)({},e),a)},i=function(e){var a=document.createElement("canvas");return new Promise(function(t,n){a.getContext?(a.width=e.videoWidth,a.height=e.videoHeight,a.getContext("2d").drawImage(e,0,0),a.toBlob(function(e){t(e)})):n("Please update your Browser")})}},740:function(e,a,t){},741:function(e,a,t){},746:function(e,a,t){"use strict";t.r(a);var n=t(63),r=t(56),i=t(12),o=t(13),c=t(211),d=t(15),l=t(14),s=t(0),m=t.n(s),u=t(3),p=t(212),f=t.n(p),v=t(656),_=t.n(v),h=t(18),g=t(83),E=(t(663),t(671)),b=(t(740),t(666)),w=function(e){Object(d.a)(t,e);var a=Object(l.a)(t);function t(){return Object(i.a)(this,t),a.apply(this,arguments)}return Object(o.a)(t,[{key:"render",value:function(){var e=this,a=this.props.cnt.map(function(a,t){return m.a.createElement("div",{className:"aroundme__form--itm__prev--wrapper",key:t},m.a.createElement("div",null,m.a.createElement("div",{className:"aroundme__form--itm__prev--close",onClick:e.props.removeMedia.bind(e,a.id)},m.a.createElement(u.a,{icon:["fas","times"]})),"image"===a.type?m.a.createElement("img",{src:a.url,alt:""}):m.a.createElement("video",{src:a.url,controls:!0},m.a.createElement("p",null,"our browser doesn't support embedded videos"))))});return m.a.createElement("div",{className:"aroundme__form--itm__prev"},a)}}]),t}(s.Component),j=(t(741),function(e){var a="Loading ....",t=["global"];return e.cnt&&(a=e.cnt),e.bg&&t.push("global--bg"),m.a.createElement("section",{className:t.join(" ")},m.a.createElement("div",{className:"global__wrapper"},m.a.createElement("div",null,m.a.createElement("div",{className:"top mask"},m.a.createElement("div",{className:"plane"})),m.a.createElement("div",{className:"middle mask"},m.a.createElement("div",{className:"plane"})),m.a.createElement("div",{className:"bottom mask"},m.a.createElement("div",{className:"plane"}))),m.a.createElement("p",null,a)))}),N=m.a.createRef(null),y=function(e){Object(d.a)(t,e);var a=Object(l.a)(t);function t(){var e;Object(i.a)(this,t);for(var o=arguments.length,d=new Array(o),l=0;l<o;l++)d[l]=arguments[l];return(e=a.call.apply(a,[this].concat(d))).state={post:{value:"",touched:!1,valid:!1},disableInput:!1,start:!1,err:null,loading:!1,media:[],chunks:[],auth:!1,status:!1,disable:!1,upload:0,mediaRecorder:null,showEmoji:!1,id:e.props.match.params.id,loaded:!1,uploadedVideo:[],uploadedImg:[],uploadedSnap:[],removedMedia:[]},e.inputChangedHandler=function(a){var t=a.target.value,n=Object(b.b)(e.state.post,{value:t,valid:""!==t,touched:!0});e.setState({post:n,err:null})},e.addEmojiHandler=function(a){var t="".concat(e.state.post.value," ").concat(a.native),n=Object(b.b)(e.state.post,{value:t,valid:""!==t,touched:!0});e.setState({post:n,err:null})},e.cameraHandler=function(){e.setState({loading:!0}),"mediaDevices"in navigator||(navigator.mediaDevices={});var a=Object(c.a)(e);"getUserMedia"in navigator.mediaDevices||(navigator.mediaDevices.getUserMedia=function(e){var t=navigator.webkitGetUserMedia||navigator.mozGetUserMedia;return t?new Promise(function(a,n){t.call(navigator,e,a,n)}):a.setState({err:"Camera access not supported by Browser!"})}),navigator.mediaDevices.getUserMedia({video:!0}).then(function(e){N.current.srcObject=e,a.setState({start:!0,loading:!1})}).catch(function(e){a.setState({err:e,start:!1,loading:!1})})},e.captureHandler=function(){N&&N.current&&Object(b.a)(N.current).then(function(a){N.current.srcObject.getVideoTracks().forEach(function(e){e.stop()});var t=Object(r.a)(e.state.media),n=window.URL.createObjectURL(a);t.push({file:a,type:"image",id:_()(),url:n}),e.setState({media:t,start:!1,err:null})}).catch(function(a){e.setState({err:a})})},e.closeCameraHandler=function(){N&&N.current&&(N.current.srcObject.getVideoTracks().forEach(function(e){e.stop()}),e.setState({start:!1,err:null,loading:!1}))},e.removeMediaHandler=function(a){var t=Object(r.a)(e.state.media),n=t.filter(function(e){return e.id!==a}),i=t.filter(function(e){return e.id===a})[0],o=e.state.uploadedImg,c=e.state.uploadedVideo,d=e.state.uploadedSnap;i&&i.uploaded&&"image"===i.type&&(o=o.filter(function(e){return e.id!==a})),i&&i.uploaded&&"video"===i.type&&(c=c.filter(function(e){return e.id!==a}),i=d.filter(function(e){return e.videoCnt===a})[0],d=d.filter(function(e){return e.videoCnt!==a}));var l=Object(r.a)(e.state.removedMedia);l.push(i),e.setState({media:n,uploadedImg:o,uploadedVideo:c,uploadedSnap:d,removedMedia:l})},e.videoRecHandler=function(){e.setState({loading:!0,rec:!0});var a=Object(c.a)(e);"mediaDevices"in navigator||(navigator.mediaDevices={}),"getUserMedia"in navigator.mediaDevices||(navigator.mediaDevices.getUserMedia=function(e){var t=navigator.webkitGetUserMedia||navigator.mozGetUserMedia;return t?new Promise(function(a,n){t.call(navigator,e,a,n)}):a.setState({err:"Camera access not supported by browser!",rec:!1})}),navigator.mediaDevices.getUserMedia({audio:!0,video:!0}).then(function(e){var t=new MediaRecorder(e);t.start(),t.ondataavailable=function(e){a.state.chunks.push(e.data)},N.current.srcObject=e,a.setState({mediaRecorder:t,start:!0,loading:!1})}).catch(function(e){a.setState({err:e,start:!1,loading:!1,rec:!1})})},e.stopRecHandler=function(){var a=e.state.mediaRecorder,t=Object(c.a)(e);a.stop(),a.onstop=function(e){var n=new Blob(t.state.chunks,{type:"mp4"});a.stream.getTracks().forEach(function(e){return e.stop()});var i=Object(r.a)(t.state.media),o=window.URL.createObjectURL(n);i.push({file:n,type:"video",id:_()(),url:o}),t.setState({mediaRecorder:null,chunks:[],media:i,start:!1,err:null,rec:!1})}},e.cancelRecHandler=function(){var a=e.state.mediaRecorder;a&&(a.stream.getTracks().forEach(function(e){return e.stop()}),e.setState({mediaRecorder:null,start:!1,err:null,loading:!1,rec:!1}))},e.uploadMediaHandler=function(){document.querySelector(".aroundme__form--itm__file").click()},e.uploadImageHandler=function(){document.querySelector(".aroundme__form--itm__img").click()},e.uploadVideoHandler=function(){document.querySelector(".aroundme__form--itm__vid").click()},e.showEmojiHandler=function(){e.setState({showEmoji:!e.state.showEmoji})},e.selectMediaHandler=function(a){if(a.stopPropagation(),a.preventDefault(),a.target.files){var t=a.target.files;e.handleFiles(t)}},e.handleFiles=function(a){for(var t=Object(r.a)(e.state.media),n=0;n<a.length;n++){var i=a[n];if("video"===i.type.split("/")[0]||"image"===i.type.split("/")[0]){var o=window.URL.createObjectURL(i);t.push({file:i,type:i.type.split("/")[0],id:_()(),url:o})}}e.setState({media:t})},e.userAuthHandler=function(){e.setState({auth:!1,status:!0})},e.submitFormHandler=function(a){a.preventDefault(),e.uploadCnt(),e.setState({disable:!0})},e.closeAroundmeHandler=function(){e.props.history.goBack(),N&&N.current&&N.current.srcObject&&N.current.srcObject.getVideoTracks().forEach(function(e){e.stop()})},e.uploadCnt=function(){var a=Object(c.a)(e),t=new FormData;t.append("post",e.state.post.value),t.append("id",e.state.id),t.append("uploadedvideo",JSON.stringify(e.state.uploadedVideo)),t.append("uploadedimage",JSON.stringify(e.state.uploadedImg)),t.append("uploadedsnap",JSON.stringify(e.state.uploadedSnap)),t.append("removedmedia",JSON.stringify(e.state.removedMedia));var r,i=Object(n.a)(e.state.media);try{for(i.s();!(r=i.n()).done;){var o=r.value;if(!o.uploaded){var d=o.file.type.split("/").pop();"video"===o.file.type.split("/")[0]?t.append("video",o.file,"".concat(o.id,".").concat(d)):t.append("image",o.file,"".concat(o.id,".").concat(d))}}}catch(l){i.e(l)}finally{i.f()}f.a.post("https://www.slodge24.com/edit/aroundme",t,{onUploadProgress:function(e){if(e.lengthComputable){var t=Math.round(100*e.loaded/e.total);a.setState({upload:t})}}}).then(function(e){window.location.assign("/aroundme")}).catch(function(a){e.setState({err:a,disable:!1})})},e}return Object(o.a)(t,[{key:"componentDidMount",value:function(){var e=this;f.a.post("https://www.slodge24.com/aroundme",{id:this.state.id},{headers:{"data-categ":"fetcharoundme"}}).then(function(a){if(a.data&&a.data.cnt&&a.data.cnt.length>0){var t=a.data.cnt[0],r=[],i=[];if(t.image.length>0||t.video.length>0){var o,c=Object(n.a)(t.image);try{for(c.s();!(o=c.n()).done;){var d=o.value;r.push({id:d.id,url:"https://www.slodge24.com/media/image/".concat(d.id),type:"image",uploaded:!0})}}catch(u){c.e(u)}finally{c.f()}var l,s=Object(n.a)(t.video);try{for(s.s();!(l=s.n()).done;){var m=l.value;i.push({id:m.id,url:"https://www.slodge24.com/media/video/".concat(m.id),type:"video",uploaded:!0})}}catch(u){s.e(u)}finally{s.f()}}e.setState({post:{value:t.post,touched:!0,valid:TextTrackCue},media:[].concat(r,i),loaded:!0,uploadedVideo:t.video,uploadedImg:t.image,uploadedSnap:t.snapshot})}else e.setState({err:"Post not found"})}).catch(function(a){e.setState({err:a})})}},{key:"componentWillUnmount",value:function(){N&&N.current&&N.current.srcObject&&N.current.srcObject.getVideoTracks().forEach(function(e){e.stop()})}},{key:"render",value:function(){var e=null,a=null,t=["aroundme__form--media"],n=["aroundme__form--media__vid-hide"],r=null,i=null;this.state.upload>0&&(i=m.a.createElement("div",{style:{height:4,width:"".concat(this.state.upload,"%"),backgroundColor:"#16cf27",position:"absolute",top:0}}));var o=m.a.createElement("ul",{className:"aroundme__form--opt"},m.a.createElement("li",{className:"aroundme__form--opt__camera",onClick:this.cameraHandler},m.a.createElement(u.a,{icon:["fas","camera"]})),m.a.createElement("li",{className:"aroundme__form--opt__rec",onClick:this.videoRecHandler},m.a.createElement("div",null),m.a.createElement(u.a,{icon:["fas","video"]})),m.a.createElement("li",{className:"aroundme__form--opt__img",onClick:this.uploadImageHandler},m.a.createElement(u.a,{icon:["fas","images"]})),m.a.createElement("li",{className:"aroundme__form--opt__video",onClick:this.uploadVideoHandler},m.a.createElement(u.a,{icon:["fas","video"]})),m.a.createElement("li",{className:"aroundme__form--opt__file",onClick:this.uploadMediaHandler},m.a.createElement(u.a,{icon:["fas","upload"]})),m.a.createElement("li",{className:"aroundme__form--opt__smile",onClick:this.showEmojiHandler},m.a.createElement(u.a,{icon:["fas","smile"]})));this.state.showEmoji&&(e=m.a.createElement("div",{className:"aroundme__form--emoji"},m.a.createElement("div",{onClick:this.showEmojiHandler}),m.a.createElement(E.a,{set:"facebook",onSelect:this.addEmojiHandler}))),!this.state.loading&&!this.state.start&&this.state.media.length>0&&(a=m.a.createElement(w,{cnt:this.state.media,removeMedia:this.removeMediaHandler})),this.state.loading&&(r=m.a.createElement("div",{className:"aroundme__form--media__loading"},m.a.createElement(j,{cnt:"Initializing camera ...",bg:!0}))),(this.state.start||this.state.loading)&&(n=["aroundme__form--media__vid-show"],t.push("aroundme__form--media__show"),o=null);var c=m.a.createElement(m.a.Fragment,null,m.a.createElement("div",{className:"aroundme__form--cnt"},m.a.createElement("div",{className:"aroundme__form--cnt--wrapper"},m.a.createElement("textarea",{value:this.state.post.value,className:"aroundme__form--cnt__det--input aroundme__form--cnt__det--text",disabled:this.state.disableInput,placeholder:"Write something ....",onChange:this.inputChangedHandler}),this.state.err?m.a.createElement("div",{className:"aroundme__form--err"},this.state.err.toString()):null,e)),o,m.a.createElement("div",{className:"aroundme__form--itm"},m.a.createElement("div",{className:"aroundme__form--itm__wrapper"},m.a.createElement("input",{type:"file",multiple:!0,className:"aroundme__form--itm__file",onChange:this.selectMediaHandler,accept:"*"}),m.a.createElement("input",{type:"file",multiple:!0,className:"aroundme__form--itm__file aroundme__form--itm__vid",onChange:this.selectMediaHandler,accept:"video/*"}),m.a.createElement("input",{type:"file",multiple:!0,className:"aroundme__form--itm__file aroundme__form--itm__img",onChange:this.selectMediaHandler,accept:"image/*"}),a)),m.a.createElement("div",{className:"aroundme__form--footer"},m.a.createElement("button",{type:"submit",className:"aroundme__form--footer__btn",disabled:!this.state.post.value&&this.state.media.length<1||this.state.disable},"Post")));this.state.auth;var d=m.a.createElement(j,null);return this.state.loaded&&(d=m.a.createElement(m.a.Fragment,null,i,c,m.a.createElement("div",{className:t.join(" ")},m.a.createElement("video",{ref:N,autoPlay:!0,className:n.join(" ")},m.a.createElement("p",null,"our browser doesn't support embedded videos")),r,this.state.start?m.a.createElement("div",{className:"aroundme__form--media__snap"},this.state.rec?m.a.createElement(m.a.Fragment,null,m.a.createElement("div",{className:"aroundme__form--media__snap--wrapper aroundme__form--media__snap--wrapper__rec",onClick:this.stopRecHandler},m.a.createElement(u.a,{icon:["fas","video"]})),m.a.createElement("div",{className:"aroundme__form--media__snap--close",onClick:this.cancelRecHandler},m.a.createElement(u.a,{icon:["fas","times"]}))):m.a.createElement(m.a.Fragment,null,m.a.createElement("div",{className:"aroundme__form--media__snap--wrapper",onClick:this.captureHandler},m.a.createElement(u.a,{icon:["fas","camera"]})),m.a.createElement("div",{className:"aroundme__form--media__snap--close",onClick:this.closeCameraHandler},m.a.createElement(u.a,{icon:["fas","times"]})))):null))),m.a.createElement("form",{className:"aroundme__form",onSubmit:this.submitFormHandler},m.a.createElement("div",{className:"aroundme__form--main-cnt"},m.a.createElement("div",{className:"aroundme__form--backdrop",onClick:this.closeAroundmeHandler}),m.a.createElement("div",{className:"aroundme__form--wrapper"},d)))}}]),t}(s.Component);a.default=Object(g.f)(Object(h.b)(function(e){return{status:e.auth.status}},null)(y))}}]);
//# sourceMappingURL=6.4237764d.chunk.js.map