{"version":3,"sources":["containers/SiteMain/MainContent/Main/ChatInput/Snapshot/Snapshot.js"],"names":["videoRef","React","createRef","Snapshot","state","start","err","id","_this","props","match","params","categ","stopRecHandler","current","getImageURL","then","imageData","srcObject","getVideoTracks","forEach","track","stop","history","goBack","onUploadMedia","file","type","format","chatID","uuid","catch","setState","navigator","mediaDevices","getUserMedia","constraints","webkitGetUserMedia","mozGetUserMedia","Promise","resolve","reject","call","Error","these","this","video","stream","cnt","react__WEBPACK_IMPORTED_MODULE_4___default","a","createElement","_components_UI_Loader_Loader__WEBPACK_IMPORTED_MODULE_12__","bg","onTypingErr","className","ref","autoPlay","onClick","disabled","_fortawesome_react_fontawesome__WEBPACK_IMPORTED_MODULE_5__","icon","Component","withRouter","connect","vidRecBackdrop","dispatch","actions"],"mappings":"mPAWIA,EAAWC,IAAMC,UAAU,MACzBC,8MACFC,MAAQ,CACJC,OAAO,EACPC,IAAK,KACLC,GAAIC,EAAKC,MAAMC,MAAMC,OAAOJ,GAC5BK,MAAOJ,EAAKC,MAAMC,MAAMC,OAAOC,SAwCnCC,eAAiB,WACTb,GAAYA,EAASc,SACrBC,YAAYf,EAASc,SAASE,KAAK,SAAAC,GAC/BjB,EAASc,QAAQI,UAAUC,iBAAiBC,QAAQ,SAASC,GACzDA,EAAMC,SAEVd,EAAKC,MAAMc,QAAQC,SACnBhB,EAAKC,MAAMgB,cAAc,CAAC,CAACC,KAAMT,EAAWU,KAAM,QAASC,OAAQ,MAAMC,OAAQC,QAAUtB,EAAKJ,MAAMG,GAAIC,EAAKJ,MAAMQ,SACtHmB,MAAM,SAAAzB,GACLE,EAAKwB,SAAS,CAAC1B,6EA7CjB,iBAAkB2B,YACpBA,UAAUC,aAAe,IAGvB,iBAAkBD,UAAUC,eAC9BD,UAAUC,aAAaC,aAAe,SAASC,GAC/C,IAAID,EAAeF,UAAUI,oBAAsBJ,UAAUK,gBAE7D,OAAKH,EAIE,IAAII,QAAQ,SAASC,EAASC,GACjCN,EAAaO,KAAKT,UAAWG,EAAaI,EAASC,KAJ5CF,QAAQE,OAAO,IAAIE,MAAM,uCAQxC,IAAIC,EAAQC,KACZZ,UAAUC,aAAaC,aAAa,CAACW,OAAO,IACvC9B,KAAK,SAAS+B,GACX/C,EAASc,QAAQI,UAAW6B,EAC5BH,EAAMZ,SAAS,CAAC3B,OAAO,MAE1B0B,MAAM,SAASzB,GACZsC,EAAMZ,SAAS,CAAC1B,MAAKD,OAAO,qDAKhCL,GAAYA,EAASc,SAAWd,EAASc,QAAQI,WACjDlB,EAASc,QAAQI,UAAUC,iBAAiBC,QAAQ,SAASC,GACzDA,EAAMC,0CAoBd,IAAI0B,EAAMC,EAAAC,EAAAC,cAACC,EAAA,EAAD,CACNC,IAAE,IAUP,OARKR,KAAKzC,MAAMC,QACX2C,EAAM,MAGNH,KAAKzC,MAAME,KACXuC,KAAKpC,MAAM6C,YAAYT,KAAKzC,MAAME,KAInC2C,EAAAC,EAAAC,cAAA,OAAKI,UAAU,wBACXN,EAAAC,EAAAC,cAAA,OAAKI,UAAU,iCACTP,EACDC,EAAAC,EAAAC,cAAA,SACIK,IAAKxD,EACLyD,UAAQ,EACRF,UAAU,wCACVN,EAAAC,EAAAC,cAAA,yDAEJF,EAAAC,EAAAC,cAAA,UACIO,QAASb,KAAKhC,eACd0C,UAAU,gCACVI,UAAWd,KAAKzC,MAAMC,OACtB4C,EAAAC,EAAAC,cAACS,EAAA,EAAD,CAAiBC,KAAM,CAAC,MAAO,UAAWN,UAAU,yDArFrDO,aA0GRC,sBAAWC,YAbF,SAAA5D,GACpB,MAAO,CACH6D,eAAgB7D,EAAM4C,IAAIiB,iBAIP,SAAAC,GACvB,MAAO,CACHZ,YAAa,SAAChD,GAAD,OAAS4D,EAASC,IAAqB7D,KACpDmB,cAAe,SAACuB,EAAKzC,EAAIK,GAAV,OAAoBsD,EAASC,KAAwBnB,EAAKzC,EAAIK,OAI3DoD,CAA6C7D","file":"static/js/6.52984d99.chunk.js","sourcesContent":["import React, { Component } from 'react';\r\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\r\nimport { connect } from 'react-redux';\r\nimport uuid from 'uuid';\r\nimport { withRouter } from 'react-router-dom';\r\n\r\nimport './Snapshot.css';\r\nimport { getImageURL } from '../../../../../../shared/utility';\r\nimport * as actions from '../../../../../../store/actions/index';\r\nimport Loader from '../../../../../../components/UI/Loader/Loader';\r\n\r\nlet videoRef = React.createRef(null);\r\nclass Snapshot extends Component {\r\n    state = {\r\n        start: false,\r\n        err: null,\r\n        id: this.props.match.params.id,\r\n        categ: this.props.match.params.categ,\r\n    };\r\n\r\n    componentDidMount() {\r\n        if (!('mediaDevices' in navigator)) {\r\n            navigator.mediaDevices = {};\r\n        }\r\n        \r\n        if (!('getUserMedia' in navigator.mediaDevices)) {\r\n            navigator.mediaDevices.getUserMedia = function(constraints) {\r\n            var getUserMedia = navigator.webkitGetUserMedia || navigator.mozGetUserMedia;\r\n        \r\n            if (!getUserMedia) {\r\n                return Promise.reject(new Error('getUserMedia is not implemented!'));\r\n            }\r\n        \r\n            return new Promise(function(resolve, reject) {\r\n                getUserMedia.call(navigator, constraints, resolve, reject);\r\n            });\r\n            }\r\n        }\r\n        let these = this;\r\n        navigator.mediaDevices.getUserMedia({video: true})\r\n            .then(function(stream) {\r\n                videoRef.current.srcObject= stream;\r\n                these.setState({start: true})\r\n            })\r\n            .catch(function(err) {\r\n                these.setState({err, start: false})\r\n            });\r\n    }\r\n\r\n    componentWillUnmount() {\r\n        if (videoRef && videoRef.current && videoRef.current.srcObject) {\r\n            videoRef.current.srcObject.getVideoTracks().forEach(function(track) {\r\n                track.stop();\r\n            });\r\n        }\r\n    }\r\n\r\n    stopRecHandler = () => {\r\n        if (videoRef && videoRef.current) {\r\n            getImageURL(videoRef.current).then(imageData => {\r\n                videoRef.current.srcObject.getVideoTracks().forEach(function(track) {\r\n                    track.stop();\r\n                });\r\n                this.props.history.goBack()\r\n                this.props.onUploadMedia([{file: imageData, type: 'image', format: 'png',chatID: uuid()}], this.state.id, this.state.categ)\r\n            }).catch(err => {\r\n                this.setState({err})\r\n            })\r\n        }\r\n    }\r\n\r\n    render() {\r\n        let cnt = <Loader \r\n            bg/>\r\n\r\n        if (this.state.start) {\r\n            cnt = null\r\n        }\r\n\r\n        if (this.state.err) {\r\n            this.props.onTypingErr(this.state.err)\r\n        }\r\n\r\n       return(\r\n           <div className=\"site-main__chat--cam\">\r\n               <div className=\"site-main__chat--cam__wrapper\">\r\n                    {cnt }\r\n                    <video \r\n                        ref={videoRef}\r\n                        autoPlay\r\n                        className=\"site-main__chat--cam__video--wrapper\">\r\n                        <p>our browser doesn't support embedded videos</p>\r\n                    </video>\r\n                    <button \r\n                        onClick={this.stopRecHandler}\r\n                        className=\"site-main__chat--cam__control\"\r\n                        disabled={!this.state.start}>\r\n                        <FontAwesomeIcon icon={['fas', 'camera']} className=\"icon icon__site-main--chat__footer--camera\"/>\r\n                    </button>\r\n               </div>\r\n           </div>\r\n       )\r\n    }\r\n}\r\n\r\nconst mapStateToProps = state => {\r\n    return {\r\n        vidRecBackdrop: state.cnt.vidRecBackdrop\r\n    };\r\n }\r\n\r\nconst mapDispatchToProps = dispatch => {\r\n    return {\r\n        onTypingErr: (err) => dispatch(actions.fetchCntFail(err)),\r\n        onUploadMedia: (cnt, id, categ) => dispatch(actions.uploadMediaInit(cnt, id, categ))\r\n    };\r\n};\r\n\r\nexport default withRouter(connect(mapStateToProps, mapDispatchToProps)(Snapshot)); "],"sourceRoot":""}