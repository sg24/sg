{"ast":null,"code":"import _JSON$stringify from \"@babel/runtime-corejs2/core-js/json/stringify\";\nimport _regeneratorRuntime from \"@babel/runtime-corejs2/regenerator\";\n\nvar _marked =\n/*#__PURE__*/\n_regeneratorRuntime.mark(fetchCntInitSaga),\n    _marked2 =\n/*#__PURE__*/\n_regeneratorRuntime.mark(changeFavSaga),\n    _marked3 =\n/*#__PURE__*/\n_regeneratorRuntime.mark(changeCntInitSaga);\n\nimport { put, delay } from 'redux-saga/effects';\nimport { changeFav } from '../../shared/utility';\nimport * as actions from '../../store/actions/index';\nimport axios from '../../axios';\nexport function fetchCntInitSaga(action) {\n  var model, categ, response;\n  return _regeneratorRuntime.wrap(function fetchCntInitSaga$(_context) {\n    while (1) {\n      switch (_context.prev = _context.next) {\n        case 0:\n          model = action.fetchType === 'post' ? '/post' : action.fetchType === 'question' || action.fetchType === 'shared' ? '/question' : '/' + action.fetchType;\n          categ = action.fetchType === 'shared' ? \"shared-\".concat(action.userID) : action.fetchType;\n\n          if (!(action.cntTotal > action.skipCnt)) {\n            _context.next = 5;\n            break;\n          }\n\n          _context.next = 5;\n          return put(actions.fetchCntStart());\n\n        case 5:\n          _context.prev = 5;\n\n          if (!(action.cntTotal === 0 || action.cntTotal > action.skipCnt)) {\n            _context.next = 12;\n            break;\n          }\n\n          _context.next = 9;\n          return axios.post(model, null, {\n            headers: {\n              'data-categ': categ,\n              'limit': action.fetchLimit,\n              'skip': action.skipCnt\n            }\n          });\n\n        case 9:\n          response = _context.sent;\n          _context.next = 12;\n          return put(actions.fetchCnt(response.data.cnt, action.skipCnt, response.data.cntTotal));\n\n        case 12:\n          _context.next = 18;\n          break;\n\n        case 14:\n          _context.prev = 14;\n          _context.t0 = _context[\"catch\"](5);\n          _context.next = 18;\n          return put(actions.fetchCntFail(_context.t0));\n\n        case 18:\n        case \"end\":\n          return _context.stop();\n      }\n    }\n  }, _marked, null, [[5, 14]]);\n}\nexport function changeFavSaga(action) {\n  var updateFav, field;\n  return _regeneratorRuntime.wrap(function changeFavSaga$(_context2) {\n    while (1) {\n      switch (_context2.prev = _context2.next) {\n        case 0:\n          updateFav = changeFav(action.id, action.liked, action.favAdd, action.changedFav);\n          _context2.next = 3;\n          return put(actions.changeMainFavoriteStart(updateFav.favDet.liked));\n\n        case 3:\n          _context2.next = 5;\n          return put(actions.changeFavPtStart(updateFav.favDet.id, updateFav.favDet.liked));\n\n        case 5:\n          _context2.prev = 5;\n          field = action.cntGrp === 'post' ? 'postID' : action.cntGrp === 'question' ? 'queID' : 'pwtID';\n          _context2.next = 9;\n          return axios.patch('/header', {\n            id: updateFav.favDet.id,\n            model: action.cntGrp,\n            field: field\n          }, {\n            headers: {\n              'data-categ': 'changefavorite'\n            }\n          });\n\n        case 9:\n          _context2.next = 11;\n          return delay(500);\n\n        case 11:\n          _context2.next = 13;\n          return put(actions.changeMainFavoriteReset());\n\n        case 13:\n          _context2.next = 15;\n          return put(actions.changeFav(updateFav.updateChangeFav));\n\n        case 15:\n          _context2.next = 25;\n          break;\n\n        case 17:\n          _context2.prev = 17;\n          _context2.t0 = _context2[\"catch\"](5);\n          _context2.next = 21;\n          return delay(500);\n\n        case 21:\n          _context2.next = 23;\n          return put(actions.changeMainFavoriteReset());\n\n        case 23:\n          _context2.next = 25;\n          return put(actions.changeFavPtFail());\n\n        case 25:\n        case \"end\":\n          return _context2.stop();\n      }\n    }\n  }, _marked2, null, [[5, 17]]);\n}\nexport function changeCntInitSaga(action) {\n  var field, payload;\n  return _regeneratorRuntime.wrap(function changeCntInitSaga$(_context3) {\n    while (1) {\n      switch (_context3.prev = _context3.next) {\n        case 0:\n          field = action.modelType === 'post' ? 'postID' : action.modelType === 'question' ? 'queID' : 'pwtID';\n\n          if (action.confirm) {\n            _context3.next = 5;\n            break;\n          }\n\n          _context3.next = 4;\n          return put(actions.changeCntStart(action.title, action.id, action.det, action.modelType));\n\n        case 4:\n          return _context3.abrupt(\"return\");\n\n        case 5:\n          if (!(action.det === 'addUser')) {\n            _context3.next = 8;\n            break;\n          }\n\n          _context3.next = 8;\n          return put(actions.changeCntStart(action.title, action.id, action.det, action.modelType));\n\n        case 8:\n          _context3.prev = 8;\n\n          if (!(action.det === 'delete')) {\n            _context3.next = 15;\n            break;\n          }\n\n          payload = _JSON$stringify({\n            id: action.id,\n            model: action.modelType,\n            field: field\n          });\n          _context3.next = 13;\n          return axios[\"delete\"]('/header', {\n            headers: {\n              'data-categ': \"deletecnt-\".concat(payload)\n            }\n          });\n\n        case 13:\n          _context3.next = 22;\n          break;\n\n        case 15:\n          if (!(action.modelType === 'user')) {\n            _context3.next = 20;\n            break;\n          }\n\n          _context3.next = 18;\n          return axios.patch('/users', {\n            id: action.id\n          }, {\n            headers: {\n              'data-categ': action.det\n            }\n          });\n\n        case 18:\n          _context3.next = 22;\n          break;\n\n        case 20:\n          _context3.next = 22;\n          return axios.patch('/header', {\n            id: action.id,\n            model: action.modelType,\n            field: field\n          }, {\n            headers: {\n              'data-categ': 'draftmode'\n            }\n          });\n\n        case 22:\n          _context3.next = 24;\n          return put(actions.changeCnt());\n\n        case 24:\n          _context3.next = 26;\n          return delay(1000);\n\n        case 26:\n          _context3.next = 28;\n          return put(actions.changeCntReset(true));\n\n        case 28:\n          _context3.next = 38;\n          break;\n\n        case 30:\n          _context3.prev = 30;\n          _context3.t0 = _context3[\"catch\"](8);\n          _context3.next = 34;\n          return put(actions.changeCntFail(_context3.t0));\n\n        case 34:\n          _context3.next = 36;\n          return delay(1000);\n\n        case 36:\n          _context3.next = 38;\n          return put(actions.changeCntReset(false));\n\n        case 38:\n        case \"end\":\n          return _context3.stop();\n      }\n    }\n  }, _marked3, null, [[8, 30]]);\n}","map":{"version":3,"sources":["C:/Users/g/my-sg final deploy/react/index/store/sagas/model.js"],"names":["fetchCntInitSaga","changeFavSaga","changeCntInitSaga","put","delay","changeFav","actions","axios","action","model","fetchType","categ","userID","cntTotal","skipCnt","fetchCntStart","post","headers","fetchLimit","response","fetchCnt","data","cnt","fetchCntFail","updateFav","id","liked","favAdd","changedFav","changeMainFavoriteStart","favDet","changeFavPtStart","field","cntGrp","patch","changeMainFavoriteReset","updateChangeFav","changeFavPtFail","modelType","confirm","changeCntStart","title","det","payload","changeCnt","changeCntReset","changeCntFail"],"mappings":"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","sourcesContent":["import { put, delay } from 'redux-saga/effects';\r\nimport { changeFav } from '../../shared/utility';\r\nimport * as actions from '../../store/actions/index';\r\nimport axios from '../../axios';\r\n\r\nexport function* fetchCntInitSaga(action) {\r\n    let model = action.fetchType === 'post' ? '/post' : action.fetchType === 'question' || action.fetchType === 'shared' ?\r\n    '/question':'/'+action.fetchType;\r\n    let categ = action.fetchType === 'shared' ? `shared-${action.userID}` : action.fetchType;\r\n    if (action.cntTotal > action.skipCnt) {\r\n        yield put(actions.fetchCntStart());\r\n    }\r\n    \r\n    try {\r\n        if (action.cntTotal === 0 || action.cntTotal > action.skipCnt) {\r\n            let response = yield axios.post(model, null,{\r\n                headers: {\r\n                    'data-categ': categ,\r\n                    'limit': action.fetchLimit, \r\n                    'skip': action.skipCnt}});\r\n            yield put(actions.fetchCnt(response.data.cnt, action.skipCnt, response.data.cntTotal));\r\n        }  \r\n        \r\n    } catch(err){\r\n        yield put(actions.fetchCntFail(err))\r\n    }\r\n    \r\n}\r\n\r\nexport function* changeFavSaga(action) {\r\n    let updateFav = changeFav(action.id ,action.liked, action.favAdd, action.changedFav);\r\n    yield put(actions.changeMainFavoriteStart(updateFav.favDet.liked));\r\n    yield put(actions.changeFavPtStart(updateFav.favDet.id, updateFav.favDet.liked))\r\n    try {\r\n        let field = action.cntGrp === 'post' ? 'postID' : action.cntGrp === 'question' ?\r\n        'queID' : 'pwtID';\r\n        yield axios.patch('/header', {id: updateFav.favDet.id, model: action.cntGrp, field},{headers: {'data-categ': 'changefavorite'}});\r\n        yield delay(500)\r\n        yield put(actions.changeMainFavoriteReset());\r\n        yield put(actions.changeFav(updateFav.updateChangeFav));\r\n    }catch(err){\r\n        yield delay(500)\r\n        yield put(actions.changeMainFavoriteReset());\r\n        yield put(actions.changeFavPtFail())\r\n    }\r\n}\r\n\r\nexport function* changeCntInitSaga(action) {\r\n    let field =   action.modelType === 'post' ? 'postID' : action.modelType === 'question' ? 'queID' : 'pwtID'\r\n    if (!action.confirm) {\r\n        yield put(actions.changeCntStart(action.title, action.id, action.det, action.modelType))\r\n        return;\r\n    }\r\n    if (action.det === 'addUser') {\r\n        yield put(actions.changeCntStart(action.title, action.id, action.det, action.modelType))\r\n    }\r\n\r\n    try {\r\n        if (action.det === 'delete') {\r\n            let payload = JSON.stringify({id: action.id, model: action.modelType, field})\r\n            yield axios.delete('/header', {headers: {'data-categ': `deletecnt-${payload}`}});\r\n        } else if (action.modelType === 'user') {\r\n            yield axios.patch('/users', {id: action.id}, {headers: {'data-categ': action.det}});\r\n        } else {\r\n            yield axios.patch('/header', {id: action.id, model: action.modelType, field} ,{headers: {'data-categ': 'draftmode'}});\r\n        }\r\n        yield put(actions.changeCnt())\r\n        yield delay(1000);\r\n        yield put(actions.changeCntReset(true))\r\n    } catch(err){\r\n        yield put(actions.changeCntFail(err))\r\n        yield delay(1000);\r\n        yield put(actions.changeCntReset(false))\r\n    }\r\n}"]},"metadata":{},"sourceType":"module"}